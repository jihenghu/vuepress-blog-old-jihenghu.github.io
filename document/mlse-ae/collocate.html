<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Res1 èåˆ(Collocation)å¤„ç†è¯´æ˜ | HERRERA21</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/logo_1.jpg">
    <meta name="description" content="Do not go gentle into that good night">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/assets/css/0.styles.b766760d.css" as="style"><link rel="preload" href="/assets/js/app.84efe3cb.js" as="script"><link rel="preload" href="/assets/js/3.a3aaa010.js" as="script"><link rel="preload" href="/assets/js/1.f6ff2096.js" as="script"><link rel="preload" href="/assets/js/23.d1a88016.js" as="script"><link rel="prefetch" href="/assets/js/10.910481d9.js"><link rel="prefetch" href="/assets/js/11.93284723.js"><link rel="prefetch" href="/assets/js/12.e7736cc1.js"><link rel="prefetch" href="/assets/js/13.17355dd0.js"><link rel="prefetch" href="/assets/js/14.85884ad0.js"><link rel="prefetch" href="/assets/js/15.1bfd135b.js"><link rel="prefetch" href="/assets/js/16.1ec90c07.js"><link rel="prefetch" href="/assets/js/17.079f4d4c.js"><link rel="prefetch" href="/assets/js/18.7cb12f6d.js"><link rel="prefetch" href="/assets/js/19.94499731.js"><link rel="prefetch" href="/assets/js/20.7b1459b5.js"><link rel="prefetch" href="/assets/js/21.3ee3a6e7.js"><link rel="prefetch" href="/assets/js/22.6e66727b.js"><link rel="prefetch" href="/assets/js/24.6805c447.js"><link rel="prefetch" href="/assets/js/25.672046e4.js"><link rel="prefetch" href="/assets/js/26.811ff7a8.js"><link rel="prefetch" href="/assets/js/27.602fcbf5.js"><link rel="prefetch" href="/assets/js/28.f3b6cf79.js"><link rel="prefetch" href="/assets/js/29.17eb6a32.js"><link rel="prefetch" href="/assets/js/30.348b5dc5.js"><link rel="prefetch" href="/assets/js/31.7c5b8704.js"><link rel="prefetch" href="/assets/js/32.23aa9611.js"><link rel="prefetch" href="/assets/js/33.7512e85b.js"><link rel="prefetch" href="/assets/js/34.1d9445c2.js"><link rel="prefetch" href="/assets/js/35.c268eff8.js"><link rel="prefetch" href="/assets/js/36.1e0f3a32.js"><link rel="prefetch" href="/assets/js/37.ee7e9551.js"><link rel="prefetch" href="/assets/js/38.8fc26356.js"><link rel="prefetch" href="/assets/js/39.376bc501.js"><link rel="prefetch" href="/assets/js/4.3c60d52f.js"><link rel="prefetch" href="/assets/js/40.79ec5ca8.js"><link rel="prefetch" href="/assets/js/41.b6826f81.js"><link rel="prefetch" href="/assets/js/42.8edec565.js"><link rel="prefetch" href="/assets/js/43.75e1b398.js"><link rel="prefetch" href="/assets/js/44.606048d9.js"><link rel="prefetch" href="/assets/js/45.52cc7a17.js"><link rel="prefetch" href="/assets/js/46.035206fe.js"><link rel="prefetch" href="/assets/js/47.af896726.js"><link rel="prefetch" href="/assets/js/48.b6ea32e9.js"><link rel="prefetch" href="/assets/js/49.8c4101b3.js"><link rel="prefetch" href="/assets/js/5.fdb8e8f3.js"><link rel="prefetch" href="/assets/js/50.fa471f22.js"><link rel="prefetch" href="/assets/js/51.4b829392.js"><link rel="prefetch" href="/assets/js/52.c6b64162.js"><link rel="prefetch" href="/assets/js/53.74ea9152.js"><link rel="prefetch" href="/assets/js/54.a705698b.js"><link rel="prefetch" href="/assets/js/55.5b6e8824.js"><link rel="prefetch" href="/assets/js/56.f502c686.js"><link rel="prefetch" href="/assets/js/57.64acd402.js"><link rel="prefetch" href="/assets/js/58.13178010.js"><link rel="prefetch" href="/assets/js/59.7c77b928.js"><link rel="prefetch" href="/assets/js/6.b3240ba5.js"><link rel="prefetch" href="/assets/js/60.eb58b247.js"><link rel="prefetch" href="/assets/js/61.da17a9ec.js"><link rel="prefetch" href="/assets/js/62.01a37a3c.js"><link rel="prefetch" href="/assets/js/63.242e8fb8.js"><link rel="prefetch" href="/assets/js/64.57ecb7c4.js"><link rel="prefetch" href="/assets/js/65.963a41ea.js"><link rel="prefetch" href="/assets/js/66.c4d00490.js"><link rel="prefetch" href="/assets/js/67.c91612ef.js"><link rel="prefetch" href="/assets/js/68.b34c0e86.js"><link rel="prefetch" href="/assets/js/69.55ba8c4c.js"><link rel="prefetch" href="/assets/js/7.f8982902.js"><link rel="prefetch" href="/assets/js/70.fccbe541.js"><link rel="prefetch" href="/assets/js/71.ff487847.js"><link rel="prefetch" href="/assets/js/72.a3bac733.js"><link rel="prefetch" href="/assets/js/73.2051552a.js"><link rel="prefetch" href="/assets/js/74.36d4b632.js"><link rel="prefetch" href="/assets/js/75.f7d15781.js"><link rel="prefetch" href="/assets/js/76.98571538.js"><link rel="prefetch" href="/assets/js/77.cd5b3b29.js"><link rel="prefetch" href="/assets/js/8.92693fd7.js"><link rel="prefetch" href="/assets/js/9.2c2ca473.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b766760d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-dad8a512><div data-v-dad8a512><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-dad8a512 data-v-dad8a512><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-dad8a512 data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>HERRERA21</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>HERRERA21</span>
          Â Â 
          <!---->
          2020
        </a></span></div></div> <div class="hide" data-v-dad8a512><header class="navbar" data-v-dad8a512><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo_1.jpg" alt="HERRERA21" class="logo"> <span class="site-name">HERRERA21</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/index.html" class="nav-link"><i class="iconfont reco-home"></i>
  ä¸»é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åˆ†ç±»
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/åç«¯/" class="nav-link"><i class="iconfont undefined"></i>
  åç«¯
</a></li><li class="dropdown-item"><!----> <a href="/categories/éšç¬”/" class="nav-link"><i class="iconfont undefined"></i>
  éšç¬”
</a></li><li class="dropdown-item"><!----> <a href="/categories/ç§‘ç ”/" class="nav-link"><i class="iconfont undefined"></i>
  ç§‘ç ”
</a></li><li class="dropdown-item"><!----> <a href="/categories/å‰ç«¯/" class="nav-link"><i class="iconfont undefined"></i>
  å‰ç«¯
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  æ ‡ç­¾
</a></div><div class="nav-item"><a href="/document/" class="nav-link router-link-active"><i class="iconfont reco-suggestion"></i>
  æ–‡æ¡£
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      å…¶å®ƒ
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>ProjectsğŸˆ</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/other/project.html" class="nav-link"><i class="iconfont undefined"></i>
  My Project
</a></li></ul></li><li class="dropdown-item"><h4>NotesğŸˆ</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learnote/" class="nav-link"><i class="iconfont undefined"></i>
  Learning notes
</a></li></ul></li><li class="dropdown-item"><h4>ååŒåˆ†æå¹³å°ğŸˆ</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mpcaplas/" class="nav-link"><i class="iconfont undefined"></i>
  ååŒåˆ†æå¹³å°
</a></li><li class="dropdown-subitem"><a href="/mpcaplas/dataset/" class="nav-link"><i class="iconfont undefined"></i>
  åå°æ•°æ®é›†è¯´æ˜æ–‡æ¡£
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  æ—¶é—´çº¿
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont reco-message"></i>
  å…³äº
</a></div> <a href="https://github.com/jihenghu/jihenghu.github.io" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask" data-v-dad8a512></div> <aside class="sidebar" data-v-dad8a512><div class="personal-info-wrapper" data-v-ca798c94 data-v-dad8a512><img src="/logo_1.jpg" alt="author-avatar" class="personal-img" data-v-ca798c94> <h3 class="name" data-v-ca798c94>
    HERRERA21
  </h3> <div class="num" data-v-ca798c94><div data-v-ca798c94><h3 data-v-ca798c94>7</h3> <h6 data-v-ca798c94>Article</h6></div> <div data-v-ca798c94><h3 data-v-ca798c94>6</h3> <h6 data-v-ca798c94>Tag</h6></div></div> <hr data-v-ca798c94></div> <nav class="nav-links"><div class="nav-item"><a href="/index.html" class="nav-link"><i class="iconfont reco-home"></i>
  ä¸»é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åˆ†ç±»
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/åç«¯/" class="nav-link"><i class="iconfont undefined"></i>
  åç«¯
</a></li><li class="dropdown-item"><!----> <a href="/categories/éšç¬”/" class="nav-link"><i class="iconfont undefined"></i>
  éšç¬”
</a></li><li class="dropdown-item"><!----> <a href="/categories/ç§‘ç ”/" class="nav-link"><i class="iconfont undefined"></i>
  ç§‘ç ”
</a></li><li class="dropdown-item"><!----> <a href="/categories/å‰ç«¯/" class="nav-link"><i class="iconfont undefined"></i>
  å‰ç«¯
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  æ ‡ç­¾
</a></div><div class="nav-item"><a href="/document/" class="nav-link router-link-active"><i class="iconfont reco-suggestion"></i>
  æ–‡æ¡£
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      å…¶å®ƒ
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>ProjectsğŸˆ</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/other/project.html" class="nav-link"><i class="iconfont undefined"></i>
  My Project
</a></li></ul></li><li class="dropdown-item"><h4>NotesğŸˆ</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learnote/" class="nav-link"><i class="iconfont undefined"></i>
  Learning notes
</a></li></ul></li><li class="dropdown-item"><h4>ååŒåˆ†æå¹³å°ğŸˆ</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mpcaplas/" class="nav-link"><i class="iconfont undefined"></i>
  ååŒåˆ†æå¹³å°
</a></li><li class="dropdown-subitem"><a href="/mpcaplas/dataset/" class="nav-link"><i class="iconfont undefined"></i>
  åå°æ•°æ®é›†è¯´æ˜æ–‡æ¡£
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  æ—¶é—´çº¿
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont reco-message"></i>
  å…³äº
</a></div> <a href="https://github.com/jihenghu/jihenghu.github.io" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <ul class="sidebar-links"><li><a href="/document/" aria-current="page" class="sidebar-link">æ–‡æ¡£æ¦‚è§ˆ</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>AMSR-E MLSEåæ¼”æ–‡æ¡£</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/document/mlse-ae/prefix.html" class="sidebar-link">MLSE ä¸­å›½ version2 è¯´æ˜æ–‡æ¡£ - å‰è¨€</a></li><li><a href="/document/mlse-ae/2a.html" class="sidebar-link">AMSR-E L2A æ•°æ®é¢„å¤„ç†è¯´æ˜</a></li><li><a href="/document/mlse-ae/2b.html" class="sidebar-link">AMSR-E L2B æ•°æ®é¢„å¤„ç†è¯´æ˜</a></li><li><a href="/document/mlse-ae/06.html" class="sidebar-link">MYD06 L2 æ•°æ®é¢„å¤„ç†è¯´æ˜</a></li><li><a href="/document/mlse-ae/20c.html" class="sidebar-link">ERA-20C æ•°æ®é¢„å¤„ç†è¯´æ˜</a></li><li><a href="/document/mlse-ae/collocate.html" aria-current="page" class="active sidebar-link">Res1 èåˆ(Collocation)å¤„ç†è¯´æ˜</a></li><li><a href="/document/mlse-ae/retrieve.html" class="sidebar-link">åæ¼”è¯´æ˜</a></li><li><a href="/document/mlse-ae/res3.html" class="sidebar-link">Res3 MLSEåæ¼”è¯´æ˜</a></li><li><a href="/document/mlse-ae/misc.html" class="sidebar-link">åæœŸå¤„ç†è¯´æ˜</a></li><li><a href="/document/mlse-ae/mwsim.html" class="sidebar-link">MWRTæ¨¡å¼çš„å®‰è£…å’Œä½¿ç”¨è¯´æ˜</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GMI MLSEåæ¼”æ–‡æ¡£</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>Res1 èåˆ(Collocation)å¤„ç†è¯´æ˜</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>HERRERA21</span>
          Â Â 
          <!---->
          2020
        </a></span></div></div> <div data-v-dad8a512><main class="page"><div class="page-title" style="display:none;"><h1>Res1 èåˆ(Collocation)å¤„ç†è¯´æ˜</h1> <hr> <div data-v-aa64b9d0><i class="iconfont reco-account" data-v-aa64b9d0><span data-v-aa64b9d0>HERRERA21</span></i> <i class="iconfont reco-date" data-v-aa64b9d0><span data-v-aa64b9d0>2019-06-28</span></i> <i class="iconfont reco-eye" data-v-aa64b9d0><span id="/document/mlse-ae/collocate.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-aa64b9d0><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><p></p><div class="table-of-contents"><ul><li><a href="#æ–‡ä»¶å¤¹å†…å®¹">- æ–‡ä»¶å¤¹å†…å®¹</a></li><li><a href="#è¿è¡Œæ–¹å¼">- è¿è¡Œæ–¹å¼</a></li><li><a href="#ä¸Šæ¸¸æ•°æ®é›†">- ä¸Šæ¸¸æ•°æ®é›†</a></li><li><a href="#è¾“å‡ºè¯´æ˜">- è¾“å‡ºè¯´æ˜</a></li><li><a href="#æµç¨‹">- æµç¨‹</a></li><li><a href="#å»ºè®®">- å»ºè®®</a></li><li><a href="#é™„å½•">-é™„å½•</a></li></ul></div><p></p> <h2 id="æ–‡ä»¶å¤¹å†…å®¹"><a href="#æ–‡ä»¶å¤¹å†…å®¹" class="header-anchor">#</a> - æ–‡ä»¶å¤¹å†…å®¹</h2> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>+ data           <span class="token comment"># æ•°æ®ç”Ÿæˆæ–‡ä»¶å¤¹</span>
- collocate.f    <span class="token comment"># ä¸»è¦çš„å¤„ç†ç¨‹åºï¼Œfortran 77è¯­è¨€ç¼–å†™</span>
- collocate.exe  <span class="token comment"># gfortran collocate.f -o collocate.exe ç”Ÿæˆçš„å¯æ‰§è¡Œç¨‹åº</span>
- batch.sh       <span class="token comment"># æ‰¹é‡æ§åˆ¶è„šæœ¬</span>
- <span class="token number">20040102</span>-20040103.log  <span class="token comment"># æ‰¹é‡å¤„ç†æ—¥å¿—</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><hr> <h2 id="è¿è¡Œæ–¹å¼"><a href="#è¿è¡Œæ–¹å¼" class="header-anchor">#</a> - è¿è¡Œæ–¹å¼</h2> <ul><li><p>å•ä¸ªæ—¥æœŸå¤„ç†ï¼ˆå¦‚2004å¹´1æœˆ1æ—¥)</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$./collocate.exe <span class="token number">20040101</span>
        <span class="token number">1511</span>         <span class="token number">911</span>
 start
 <span class="token number">20040101</span>
 <span class="token punctuation">..</span>/2b/data/AEL2B.SurfaceRain.res5km.20040101.txt             <span class="token function">open</span>
 MYD06.cloud.properties.res5km.20040101.txt                   <span class="token function">open</span>
 MYD06.cloud.properties.res5km.20040101.txt                   cloud <span class="token builtin class-name">read</span> <span class="token keyword">done</span>
 readingERA20C.EAsia.27L.12km.20040101                              
 AEL2A.masked.TB.res1.20040101.txt                            <span class="token function">open</span>
 <span class="token number">20040101</span> collocate <span class="token keyword">done</span>
 <span class="token number">20040101</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>fortranå¸¦å‚æ–¹å¼è¿è¡Œ ï¼Œfortran ä»£ç å†…éƒ¨çš„è¯­å¥ï¼š</p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code><span class="token keyword">call</span> getarg<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>ymd<span class="token punctuation">)</span>      <span class="token comment">!!!æ•°å­—ä½è¡¨ç¤ºå‚æ•°ä½ç½®ï¼Œèµ‹å€¼ç»™ymdï¼›0è¡¨ç¤ºå‘½ä»¤æœ¬èº«ï¼Œ1è¡¨ç¤ºå‘½ä»¤åçš„ç¬¬ä¸€ä¸ªå‚æ•°</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>./collocate.exe 20040101</code>å¯ä»¥å°†<code>20040101</code>èµ‹å€¼ç»™å˜é‡ymdã€‚</p> <p>è¿è¡Œç»“æœï¼šdataæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸‰ä¸ªæ–‡ä»¶ï¼š</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>-rw-rw-r--  <span class="token number">19</span>.37Mb ael2a.ael2b.myd06.era20c.basic.20040101.txt   <span class="token comment">#åŸºæœ¬å‚æ•°</span>
-rw-rw-r--  531Mb   ael2a.ael2b.myd06.era20c.hydro.20040101.txt   <span class="token comment">#æ°´å‡ç‰©å‚æ•°</span>
-rw-rw-r--  <span class="token number">173</span>.7Mb ael2a.ael2b.myd06.era20c.profile.20040101.txt <span class="token comment">#å»“çº¿å‚æ•°</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>æ‰¹é‡æ—¥æœŸå¤„ç†ï¼ˆå¦‚20040102~20040103ï¼‰</p> <p>ä½¿ç”¨<code>batch.sh</code>è„šæœ¬</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token variable">$sh</span> batch.sh <span class="token number">20040102</span> <span class="token number">20040103</span>
<span class="token number">20040102</span>
<span class="token number">20040103</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>æ—¥å¿—æ–‡ä»¶ï¼š<code>20040102-20040103.log</code></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>        <span class="token number">1511</span>         <span class="token number">911</span>
 start
 <span class="token number">20040102</span>
 <span class="token punctuation">..</span>/2b/data/AEL2B.SurfaceRain.res5km.20040102.txt             <span class="token function">open</span>       
 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
 <span class="token number">20040103</span>
 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
 <span class="token number">20040103</span> collocate <span class="token keyword">done</span>
 <span class="token number">20040103</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>collocationçš„è¿‡ç¨‹ä¼šæ¶ˆè€—å¾ˆå¤šç©ºé—´ï¼Œæ³¨æ„è§„åˆ’ã€‚</p></li></ul> <hr> <h2 id="ä¸Šæ¸¸æ•°æ®é›†"><a href="#ä¸Šæ¸¸æ•°æ®é›†" class="header-anchor">#</a> - ä¸Šæ¸¸æ•°æ®é›†</h2> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token punctuation">..</span>/2a.res1/AEL2A.masked.TB.res1.20040101.txt           <span class="token comment"># AE-L2a é¢„å¤„ç†äº§ç‰© txt</span>
 <span class="token punctuation">..</span>/2b/data/AEL2B.SurfaceRain.res5km.20040101.txt       <span class="token comment"># AE-Rain é¢„å¤„ç†äº§ç‰© txt </span>
 <span class="token punctuation">..</span>/06/MYD06.cloud.properties.res5km.20040101.txt       <span class="token comment"># MYD06 äº‘äº§å“é¢„å¤„ç†äº§ç‰©   txt  </span>
 <span class="token punctuation">..</span>/20c/readingERA20C.EAsia.27L.12km.20040101           <span class="token comment"># ERA-20C é¢„å¤„ç†å»“çº¿   äºŒè¿›åˆ¶</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>è¯»å–ç¤ºä¾‹ï¼š</p> <ul><li><p>AE-Rainï¼š</p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code> <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token keyword">end</span><span class="token operator">=</span><span class="token number">1101</span><span class="token punctuation">)</span>ip<span class="token punctuation">,</span> lon<span class="token punctuation">,</span>lat<span class="token punctuation">,</span>raintime<span class="token punctuation">,</span>rr<span class="token punctuation">,</span>frcc 
 <span class="token comment">!!202389  118.651375   10.526302    5.750000    0.000000    0.000000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>AE-L2a:</p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code> <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token keyword">end</span><span class="token operator">=</span><span class="token number">1103</span><span class="token punctuation">)</span>ip<span class="token punctuation">,</span>lon<span class="token punctuation">,</span>lat<span class="token punctuation">,</span><span class="token punctuation">(</span>tb<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>stime<span class="token punctuation">,</span>frcland
 <span class="token comment">!!    22  143.824844   49.743305  251.199997  236.269989  250.589996  237.440002  249.099991  236.299988  248.380005  236.319992  243.739990  232.899994  233.130005  225.910004    2.666667   95.000000                    </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>MYD06</p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code> <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token keyword">end</span><span class="token operator">=</span><span class="token number">1201</span><span class="token punctuation">)</span> ip<span class="token punctuation">,</span>lon<span class="token punctuation">,</span>lat<span class="token punctuation">,</span>tcloud<span class="token punctuation">,</span>cwp<span class="token punctuation">,</span>cfr<span class="token punctuation">,</span>cpi<span class="token punctuation">,</span>ctp<span class="token punctuation">,</span>cth<span class="token punctuation">,</span>ctt 
                    <span class="token comment">! 1  -   -         g/m2 %   -  hpa  m   k </span>
<span class="token comment">!  25 144.8686  36.1267  2.6167  8.9167  100.000  1.000  905.000  950.000 281.3372</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>ERA -20C</p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>       <span class="token keyword">real</span><span class="token operator">*</span><span class="token number">4</span>  pmb<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">,</span>tkk<span class="token punctuation">(</span>nlon<span class="token punctuation">,</span>nlat<span class="token punctuation">,</span>L<span class="token punctuation">,</span>mt<span class="token punctuation">)</span>
      <span class="token operator">+</span>         <span class="token punctuation">,</span>rhh<span class="token punctuation">(</span>nlon<span class="token punctuation">,</span>nlat<span class="token punctuation">,</span>L<span class="token punctuation">,</span>mt<span class="token punctuation">)</span><span class="token punctuation">,</span>zz<span class="token punctuation">(</span>nlon<span class="token punctuation">,</span>nlat<span class="token punctuation">,</span>L<span class="token punctuation">,</span>mt<span class="token punctuation">)</span>
       <span class="token keyword">real</span><span class="token operator">*</span><span class="token number">4</span>  late<span class="token punctuation">(</span>nlat<span class="token punctuation">)</span><span class="token punctuation">,</span>lone<span class="token punctuation">(</span>nlon<span class="token punctuation">)</span> 
       <span class="token keyword">real</span><span class="token operator">*</span><span class="token number">4</span>  psurf<span class="token punctuation">(</span>nlon<span class="token punctuation">,</span>nlat<span class="token punctuation">,</span>mt<span class="token punctuation">)</span><span class="token punctuation">,</span> skt<span class="token punctuation">(</span>nlon<span class="token punctuation">,</span>nlat<span class="token punctuation">,</span>mt<span class="token punctuation">)</span>
      <span class="token operator">+</span>         <span class="token punctuation">,</span>wndg<span class="token punctuation">(</span>nlon<span class="token punctuation">,</span>nlat<span class="token punctuation">,</span>mt<span class="token punctuation">)</span><span class="token punctuation">,</span>t2mg<span class="token punctuation">(</span>nlon<span class="token punctuation">,</span>nlat<span class="token punctuation">,</span>mt<span class="token punctuation">)</span> 
     
       <span class="token keyword">open</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token keyword">file</span><span class="token operator">=</span> ecmwf<span class="token punctuation">,</span>form<span class="token operator">=</span><span class="token string">&quot;unformatted&quot;</span><span class="token punctuation">,</span>access<span class="token operator">=</span><span class="token string">&quot;sequential&quot;</span><span class="token punctuation">,</span>ERR<span class="token operator">=</span><span class="token number">89</span><span class="token punctuation">)</span>		  
	         <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> pmb
	         <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> tkk
	         <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> zz
	         <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> rhh
	         <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> psurf
	         <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> skt
	         <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> t2mg
	         <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> wndg	    		       		 
		     <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> late
             <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> lone 
	         <span class="token keyword">close</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ul> <hr> <h2 id="è¾“å‡ºè¯´æ˜"><a href="#è¾“å‡ºè¯´æ˜" class="header-anchor">#</a> - è¾“å‡ºè¯´æ˜</h2> <ul><li><p>è¾“å‡ºåˆ—è¡¨</p> <div class="language-fortran 77 line-numbers-mode"><pre class="language-fortran"><code>  <span class="token comment">! do loop for every sample:</span>
         <span class="token keyword">write</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">888</span><span class="token punctuation">)</span>ip<span class="token punctuation">,</span>lon<span class="token punctuation">,</span>lat<span class="token punctuation">,</span>stime<span class="token punctuation">,</span>LST<span class="token punctuation">,</span>wnd<span class="token punctuation">,</span>t2m<span class="token punctuation">,</span>skp<span class="token punctuation">,</span>cwc<span class="token punctuation">,</span>cic<span class="token punctuation">,</span>frcland   <span class="token comment">!!è¾“å‡ºåŸºæœ¬å‚æ•°</span>
  <span class="token comment">!åˆ†åˆ«æ˜¯ï¼šåºå·ï¼Œç»åº¦ï¼Œçº¬åº¦ï¼Œæ‰«ææ—¶åˆ»ï¼ˆUTC hrï¼‰ï¼Œåœ°è¡¨æ¸©åº¦ï¼ˆKï¼‰ï¼Œ10mé£é€Ÿï¼ˆm/sï¼‰ï¼Œ2mæ¸©åº¦ï¼ˆKï¼‰</span>
  <span class="token comment">!       åœ°è¡¨æ°”å‹ï¼ˆhpaï¼‰ï¼Œæ¶²æ€æ°´è·¯å¾„ï¼ˆg/m2ï¼‰ï¼Œå†°æ€æ°´è·¯å¾„ï¼ˆg/m2ï¼‰, é™†åœ°åˆ†æ•°ï¼ˆ%ï¼‰    </span>
<span class="token number">888</span>	      <span class="token keyword">format</span><span class="token punctuation">(</span>I6<span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">(</span><span class="token number">1</span>x<span class="token punctuation">,</span>f14.<span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">!!è¾“å‡ºç¤ºä¾‹ï¼š</span>
<span class="token comment">!!95       140.0084        36.1518         3.3167       283.6469         2.9410       !!279.1640       971.9497         0.0000         0.0000        99.0000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code> <span class="token comment">!!!è¾“å‡ºå»“çº¿å’Œäº®æ¸©   </span>
<span class="token keyword">write</span><span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">999</span><span class="token punctuation">)</span>ip<span class="token punctuation">,</span>newl<span class="token punctuation">,</span><span class="token punctuation">(</span>tk<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>L<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rh<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>L<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>z<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>L<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>tb<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span>           <span class="token comment">!åˆ†åˆ«æ˜¯ï¼šåºå·ï¼Œæœ‰æ•ˆå±‚æ•°ï¼Œæ°”æ¸©å»“çº¿ï¼ˆL*K)ï¼Œç›¸å¯¹æ¹¿åº¦å»“çº¿ï¼ˆL*%ï¼‰ï¼Œé«˜åº¦å»“çº¿ï¼ˆL*mï¼‰,äº®æ¸©è°±ï¼ˆ12*kï¼‰</span>

 <span class="token comment">!!!è¾“å‡ºæ°´å‡ç‰©å»“çº¿</span>
<span class="token keyword">write</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">999</span><span class="token punctuation">)</span>ip<span class="token punctuation">,</span>qc <span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>CldWtr<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>L<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">(</span>CldIce<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>L<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
 <span class="token comment">!åˆ†åˆ«æ˜¯ï¼šåºå·ï¼Œå¤©æ°”ç±»å‹ï¼Œäº‘æ°´æ•°ç»„ï¼Œäº‘å†°æ•°ç»„ã€‚    </span>
    
<span class="token number">999</span>	      <span class="token keyword">format</span><span class="token punctuation">(</span>I6<span class="token punctuation">,</span>I6<span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">(</span><span class="token number">1</span>x<span class="token punctuation">,</span>f14.<span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul> <hr> <h2 id="æµç¨‹"><a href="#æµç¨‹" class="header-anchor">#</a> - æµç¨‹</h2> <p>å‡ ç§æ•°æ®çš„èåˆå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤:</p> <ol><li><p>ç¡®å®šä¸€ä¸ª5kmåˆ†è¾¨ç‡ï¼ˆ0.05<sup>o</sup>ï¼‰çš„æ ‡å‡†ç½‘æ ¼,æ¶µç›–æ‰€æœ‰å¾…åæ¼”çš„åŒºåŸŸï¼Œæˆ‘ä»¬å°†æ­¤ç½‘æ ¼æˆä¸ºæ“ä½œç½‘æ ¼ã€‚</p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>      lonmin<span class="token operator">=</span><span class="token number">70</span>
      lonmax<span class="token operator">=</span><span class="token number">145</span>
      latmin<span class="token operator">=</span><span class="token number">10</span>
      latmax <span class="token operator">=</span><span class="token number">55</span>
	  nx <span class="token operator">=</span> <span class="token punctuation">(</span>lonmax<span class="token operator">-</span>lonmin <span class="token punctuation">)</span><span class="token operator">/</span>d0 <span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">10</span>  <span class="token comment">!1511</span>
	  ny <span class="token operator">=</span> <span class="token punctuation">(</span>latmax<span class="token operator">-</span>latmin <span class="token punctuation">)</span><span class="token operator">/</span>d0 <span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">10</span>  <span class="token comment">!911</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>ä¸ºäº†é˜²æ­¢ä¸‹æ ‡è¶Šç•Œï¼Œåˆå§‹ç½‘æ ¼ä¸¤ä¾§å„å¢åŠ 5ä¸ªæ ¼ç‚¹ï¼Œå®é™…ä¸Šä¸ä¼šåŒ¹é…åˆ°é™æ°´å’Œäº‘ï¼Œä½†æ˜¯åœ¨å¯¹AMSR-Eåƒæ–‘åš5ä¸ªæ ¼ç‚¹åŠå¾„å¹³å‡æ—¶å¯ä»¥é˜²æ­¢è¾¹ç•Œæº¢å‡ºã€‚</p></li> <li><p>å°†AE-Rainçš„é™æ°´èµ„æ–™åŒ¹é…è¿›5kmçš„æ“ä½œç½‘æ ¼ï¼Œæœ‰é™æ°´å­˜åœ¨çš„æ ¼ç‚¹rainflagæ ‡è®°ä¸º+1ã€‚</p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>rexist <span class="token operator">=</span><span class="token number">0</span>     <span class="token comment">!æ ¼ç‚¹æ˜¯å¦æœ‰é™æ°´è§‚æµ‹æ•°æ® ï¼Œåªæœ‰é™æ°´æ•°æ®å­˜åœ¨ï¼Œæ‰ä¼šå¯¹æ ¼ç‚¹è¿›è¡Œå¤„ç†</span>
rainflag<span class="token operator">=</span><span class="token number">0</span>    <span class="token comment">!æ ¼ç‚¹æ˜¯å¦æœ‰é™æ°´ï¼Œ å­˜åœ¨é™æ°´åˆ™ä¸å¤„ç†æ ¼ç‚¹</span>
rtime <span class="token operator">=</span> <span class="token number">0</span>     <span class="token comment">!é™æ°´æ•°æ®çš„è§‚æµ‹æ—¶é—´ï¼Œç”¨äºåŒ¹é…äº‘å‚æ•°å’Œäº®æ¸©å‚æ•°ï¼Œä¿è¯è½¨é“å”¯ä¸€æ€§ã€‚</span>
....
irx<span class="token operator">=</span>int<span class="token punctuation">(</span>aint<span class="token punctuation">(</span><span class="token punctuation">(</span>lon<span class="token operator">-</span>lonmin<span class="token punctuation">)</span><span class="token operator">/</span>d0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">5</span>  <span class="token comment">!å®šä½æ‰€åœ¨çš„ç½‘æ ¼ä¸‹æ ‡</span>
iry<span class="token operator">=</span>int<span class="token punctuation">(</span>aint<span class="token punctuation">(</span><span class="token punctuation">(</span>lat<span class="token operator">-</span>latmin<span class="token punctuation">)</span><span class="token operator">/</span>d0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">5</span>
rexist<span class="token punctuation">(</span>irx<span class="token punctuation">,</span>iry<span class="token punctuation">)</span> <span class="token operator">=</span> rexist<span class="token punctuation">(</span>irx<span class="token punctuation">,</span>iry<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>        
rtime<span class="token punctuation">(</span>irx<span class="token punctuation">,</span>iry<span class="token punctuation">)</span>  <span class="token operator">=</span> rtime<span class="token punctuation">(</span>irx<span class="token punctuation">,</span>iry<span class="token punctuation">)</span><span class="token operator">+</span>raintime  <span class="token comment">!without normalized</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>rr <span class="token operator">.ne.</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token keyword">then</span>		 
    rainflag<span class="token punctuation">(</span>irx<span class="token punctuation">,</span>iry<span class="token punctuation">)</span><span class="token operator">=</span>rainflag<span class="token punctuation">(</span>irx<span class="token punctuation">,</span>iry<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>	<span class="token comment">! rain point affects only 1 grid </span>
<span class="token keyword">end if</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>**ç‰¹åˆ«è¯´æ˜ï¼ŒAE-Rainçš„ç©ºé—´åˆ†è¾¨ç‡åœ¨5kmå’Œ10kmä¹‹é—´ï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯å¦‚å›¾1æ˜¾ç¤ºçš„æ¯ä¸ªæ ¼ç‚¹éƒ½æœ‰é™æ°´è§‚æµ‹ã€‚**æ“ä½œç½‘æ ¼åªæ˜¯ç”¨æ¥å®šä½å››ç§ä¸åŒçš„æ•°æ®é›†ï¼Œæˆ‘ä»¬çš„æ“ä½œé‡ç‚¹æ˜¯AE-L2Aè§‚æµ‹æ ·æœ¬å®šä½åˆ°çš„æ ¼ç‚¹ï¼Œä¸å…³å¿ƒæ¯ä¸ªå…·ä½“æ“ä½œæ ¼ç‚¹æ˜¯å¦å®é™…ä¼šç”¨åˆ°ã€‚</p> <img src="https://ws1.sinaimg.cn/large/005zDzHply1g4lpvcmvhhj31bl0f8tck.jpg"></li></ol> <p style="text-align:center;color:navy;">å›¾1. å·¦ï¼šAE-RainåŒ¹é…è¿›æ“ä½œç½‘æ ¼ã€‚å³ï¼šå°†æœ‰é™æ°´å‘ç”Ÿçš„æ ¼ç‚¹æ ‡è®°</p> <ol start="3"><li><p>å°†MYD06è§‚æµ‹åŒ¹é…è¿›æ“ä½œç½‘æ ¼ï¼Œå¯¹äºæ²¡æœ‰é™æ°´è§‚æµ‹çš„æ ¼ç‚¹ï¼ˆrexist=0ï¼‰ä¸åšåŒ¹é…ï¼Œå¯¹æœ‰é™æ°´å‘ç”Ÿçš„æ ¼ç‚¹ï¼ˆrexist!=0 &amp;&amp; rainflag !=0ï¼‰ä¸åšåŒ¹é…ã€‚</p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>  icx<span class="token operator">=</span>int<span class="token punctuation">(</span>aint<span class="token punctuation">(</span><span class="token punctuation">(</span>lon<span class="token operator">-</span>lonmin<span class="token punctuation">)</span><span class="token operator">/</span>d0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">5</span>  <span class="token comment">! d0=0.05</span>
  icy<span class="token operator">=</span>int<span class="token punctuation">(</span>aint<span class="token punctuation">(</span><span class="token punctuation">(</span>lat<span class="token operator">-</span>latmin<span class="token punctuation">)</span><span class="token operator">/</span>d0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">5</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> rexist<span class="token punctuation">(</span>icx<span class="token punctuation">,</span>icy<span class="token punctuation">)</span><span class="token operator">.ne.</span><span class="token number">0</span> <span class="token operator">.and.</span>  rainflag<span class="token punctuation">(</span>icx<span class="token punctuation">,</span>icy<span class="token punctuation">)</span><span class="token operator">.eq.</span><span class="token number">0</span> <span class="token operator">.and.</span> <span class="token punctuation">&amp;</span>
  		abs<span class="token punctuation">(</span>rtime<span class="token punctuation">(</span>icx<span class="token punctuation">,</span>icy<span class="token punctuation">)</span><span class="token operator">/</span>rexist<span class="token punctuation">(</span>icx<span class="token punctuation">,</span>icy<span class="token punctuation">)</span><span class="token operator">-</span>tcloud<span class="token punctuation">)</span> <span class="token operator">.le.</span> <span class="token number">0.2</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
 	 	<span class="token comment">!!å¯¹äº‘è¿›è¡Œå¹³å‡çš„å¤„ç†è§ä¸‹æ–‡æ­¥éª¤4</span>
  <span class="token keyword">end if</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><img src="https://ws1.sinaimg.cn/large/005zDzHply1g4lpu8aeehj31b30f70we.jpg"> <p style="text-align:center;color:navy;">å›¾2. å·¦ï¼šå°†MYD06äº‘è§‚æµ‹åŒ¹é…è¿›æ“ä½œç½‘æ ¼ã€‚å³ï¼šå¹³å‡è½å…¥å„æ ¼ç‚¹çš„äº‘å‚æ•°ï¼Œæœ‰é™æ°´çš„æ ¼ç‚¹è¿›è¡Œç¼ºæµ‹</p> <p><code>abs(rtime(icx,icy)/rexist(icx,icy)-tcloud) .le. 0.2)</code>å¯ä»¥ä¿è¯é™æ°´è§‚æµ‹å’Œäº‘è§‚æµ‹çš„æ—¶é—´ä¿æŒåœ¨12minå†…ï¼Œè¿™è¿œè¿œå°äºAquaçš„è½¨é“å‘¨æœŸï¼ˆçº¦90minï¼‰ï¼Œä¿è¯é™æ°´ä¿¡æ¯å’Œäº‘å‚æ•°æ˜¯åœ¨åŒä¸€ä¸ªAquaè½¨é“è§‚æµ‹çš„ã€‚ä»è€Œè§£å†³äº†<strong>å›¾3</strong>ä¸­è½¨é“é‡å çš„é—®é¢˜ã€‚</p> <img src="https://ws1.sinaimg.cn/large/005zDzHply1g4gv7qipbzj30nf0hhjwf.jpg" style="height:300px;width:800px;"> <p style="text-align:center;color:navy;">å›¾3. å¯ä»¥çœ‹åˆ°MODISå’ŒAMSR-Eçš„è½¨é“åœ¨åŒ—éƒ¨æœ‰è¾ƒå¤§é¢ç§¯çš„å¼‚è½¨é‡å ï¼Œææœ‰å¯èƒ½å¯¼è‡´å·¦è¾¹è½¨é“çš„MODISåŒ¹é…åˆ°å³è¾¹è½¨é“çš„AMSR-E</p></li> <li><p>å¯¹äº‘è¿›è¡Œ50km X 50kmé¢ç§¯çš„æ ¼ç‚¹å¹³å‡ã€‚å¦‚å›¾4ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªæ“ä½œæ ¼ç‚¹ï¼Œæˆ‘ä»¬ä¼šè®²10X10æ ¼ç‚¹èŒƒå›´å†…çš„äº‘å‚æ•°å¹³å‡ä¸­èµ‹ç»™å½“å‰æ ¼ç‚¹ï¼Œè¿™æ ·åœ¨äº®æ¸©äº§å“è½è¿›è¯¥æ ¼ç‚¹æ—¶ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨åŒ¹é…åˆ°50kmåŠå¾„å†…çš„äº‘å‚æ•°å¹³å‡å€¼ã€‚æŠ˜åˆå«æ˜Ÿè§†åœºEFOVçš„å°ºå¯¸ä¸€è‡´ã€‚ï¼ˆå®é™…ä¸Šæ˜¯åˆ©ç”¨æ­£æ–¹å½¢ä»£æ›¿åœ†å½¢çš„æ–¹æ³•ï¼Œä½†æ˜¯é¢ç§¯è¦ç¨å¤§ä¸€äº›ï¼Œæ³¨æ„ï¼Œå›¾ä¸­çš„EFOVä¸ºRES3çš„åƒæ–‘ç¤ºä¾‹ï¼‰</p> <img src="https://ws1.sinaimg.cn/large/005zDzHply1g4lridf477j30jk0aedhl.jpg" style="height:300px;"> <p style="text-align:center;color:navy;">å›¾4.å°†AE-L2Açš„äº®æ¸©è§‚æµ‹å®šä½åˆ°ç½‘æ ¼å†…ï¼Œå¯¹EFOVå†…éƒ¨çš„æ“ä½œæ ¼ç‚¹è¿›è¡Œäº‘å‚æ•°çš„å¹³å‡(æ­¤å›¾ä»¥RES3ä¸ºä¾‹)</p> <ul><li>å¯¹AMSR-Eåƒæ–‘ä¸­äº‘çš„å¹³å‡å¤„ç†</li></ul> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>ik<span class="token operator">=</span><span class="token number">6</span> 
<span class="token keyword">if</span><span class="token punctuation">(</span>cpi<span class="token operator">.eq.</span><span class="token number">0</span> <span class="token punctuation">)</span>              ik<span class="token operator">=</span><span class="token number">4</span>  <span class="token comment">! clear</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>cpi<span class="token operator">.eq.</span><span class="token number">1</span> <span class="token operator">.or.</span> cpi<span class="token operator">.eq.</span><span class="token number">5</span><span class="token punctuation">)</span> ik<span class="token operator">=</span><span class="token number">1</span>  <span class="token comment">! water phase</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>cpi<span class="token operator">.eq.</span><span class="token number">2</span> <span class="token operator">.or.</span> cpi<span class="token operator">.eq.</span><span class="token number">4</span><span class="token punctuation">)</span> ik<span class="token operator">=</span><span class="token number">2</span>  <span class="token comment">! ice phase</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>cpi<span class="token operator">.eq.</span><span class="token number">3</span> <span class="token punctuation">)</span>              ik<span class="token operator">=</span><span class="token number">3</span>  <span class="token comment">! mixed phase</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>cpi<span class="token operator">.eq.</span><span class="token number">6</span> <span class="token operator">.or.</span> cpi<span class="token operator">.eq.</span><span class="token number">127</span><span class="token punctuation">)</span> ik<span class="token operator">=</span><span class="token number">5</span> <span class="token comment">!uncertain or FillValue </span>
<span class="token comment">! these two conditions should be seperated	      </span>

<span class="token keyword">do</span> i <span class="token operator">=</span> icx<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span>icx<span class="token operator">+</span><span class="token number">5</span>
    <span class="token keyword">do</span> j <span class="token operator">=</span> icy <span class="token operator">-</span><span class="token number">5</span> <span class="token punctuation">,</span>icy <span class="token operator">+</span><span class="token number">5</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>rainflag<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span> <span class="token operator">.gt.</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">cycle</span>		 
        fcwp<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>ik<span class="token punctuation">)</span><span class="token operator">=</span>fcwp<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>ik<span class="token punctuation">)</span><span class="token operator">+</span>cwp<span class="token operator">*</span>cfr<span class="token operator">/</span><span class="token number">100</span>  
        <span class="token comment">! the original CWP was normalized   by the cloud fraction</span>
        fctp<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>ik<span class="token punctuation">)</span><span class="token operator">=</span>fctp<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>ik<span class="token punctuation">)</span><span class="token operator">+</span>ctp
        fctt<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>ik<span class="token punctuation">)</span><span class="token operator">=</span>fctt<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>ik<span class="token punctuation">)</span><span class="token operator">+</span>ctt
        frc<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>ik<span class="token punctuation">)</span><span class="token operator">=</span>frc<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>ik<span class="token punctuation">)</span><span class="token operator">+</span>cfr       <span class="token comment">! 0-100</span>
        Ncloud<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>ik<span class="token punctuation">)</span><span class="token operator">=</span>Ncloud<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>ik<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>   <span class="token comment">! modis pixel in each phase</span>
        Tncloud<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token operator">=</span>Tncloud<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>       <span class="token comment">! total modis pixel in given 0.05 x 0.05 grid, should be &gt;=1, but around 1  	  </span>
    <span class="token keyword">end do</span>
<span class="token keyword">end do</span>
......
<span class="token comment">!!!å…¨éƒ¨äº‘å‚æ•°æ’’å…¥æ“ä½œæ ¼ç‚¹å®Œæ¯•åè¿›è¡Œå½’ä¸€åŒ–</span>

<span class="token comment">!!!   average cloud properties in each 0.5 by 0.5 box, all parameters are initialized as zero already      </span>
      <span class="token keyword">do</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>nx 
          <span class="token keyword">do</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>ny
              <span class="token keyword">do</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span>
                  <span class="token keyword">if</span><span class="token punctuation">(</span>Ncloud<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">.ge.</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token comment">!  if Ncloud=0, all parameter were as initialized, i.e. zero, will ctt=0 a problem?'</span>
                      fcwp<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">=</span>fcwp<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">/</span>TNcloud<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span> 
                      <span class="token comment">! cwp and frc should be averaged to the whole grid</span>
	                  fctt<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">=</span>fctt<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">/</span>Ncloud<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">)</span>
	                  fctp<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">=</span>fctp<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">/</span>Ncloud<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">)</span>
                      frc<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">)</span> <span class="token operator">=</span>frc<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">)</span> <span class="token operator">/</span>TNcloud<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span>
                  <span class="token keyword">endif</span>
              <span class="token keyword">end do</span>
          <span class="token keyword">end do</span>
       <span class="token keyword">end do</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>å¯¹äº6ä¸ªå½’ç±»åçš„ç›¸æ€ikï¼Œäº‘å‚æ•°çš„å¹³å‡æ˜¯åˆ†å¼€çš„ã€‚</p></li> <li><p>å¼•å…¥ERA-20cæ•°æ®å’ŒEC0.125<sup>o</sup>ç½‘æ ¼ï¼Œè¯¥æ•°æ®æ˜¯å…¨å¤©å…¨åŒºåŸŸçš„æ•°æ®ï¼Œå…ˆè¡Œå¯¼å…¥çš„ç›®çš„æ˜¯é¿å…é’ˆå¯¹ä¸åŒçš„äº®æ¸©è§‚æµ‹åå¤å¯¼å…¥ï¼Œæå‡æ•ˆç‡ã€‚æˆ‘ä»¬åªéœ€è¦é’ˆå¯¹æ¯ä¸ªäº®æ¸©ç¡®å®šç½‘æ ¼ä¸‹æ ‡å’Œæ—¶é—´ä¸‹æ ‡å°±å¯ä»¥é‡å¤åˆ©ç”¨å¯¼å…¥çš„å»“çº¿æ•°ç»„ã€‚</p></li> <li><p>é€æ¡å¯¼å…¥éœ€è¦åŒ¹é…çš„AE-L2aæ•°æ®å…ƒï¼Œç¡®å®š å…¶åœ¨æ“ä½œç½‘æ ¼ä¸Šçš„æ ¼ç‚¹ï¼ŒåŒ¹é…äº‘äº§å“ä¿¡æ¯ã€‚</p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>	       iix<span class="token operator">=</span>int<span class="token punctuation">(</span>aint<span class="token punctuation">(</span><span class="token punctuation">(</span>lon<span class="token operator">-</span>lonmin<span class="token punctuation">)</span><span class="token operator">/</span>d0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">5</span>
	       iiy<span class="token operator">=</span>int<span class="token punctuation">(</span>aint<span class="token punctuation">(</span><span class="token punctuation">(</span>lat<span class="token operator">-</span>latmin<span class="token punctuation">)</span><span class="token operator">/</span>d0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">5</span>
		 
       <span class="token keyword">if</span> <span class="token punctuation">(</span> rexist<span class="token punctuation">(</span>iix<span class="token punctuation">,</span>iiy<span class="token punctuation">)</span><span class="token operator">.ne.</span><span class="token number">0</span> <span class="token operator">.and.</span>  rainflag<span class="token punctuation">(</span>iix<span class="token punctuation">,</span>iiy<span class="token punctuation">)</span><span class="token operator">.eq.</span><span class="token number">0</span> <span class="token operator">.and.</span>
     <span class="token operator">+</span>       abs<span class="token punctuation">(</span>rtime<span class="token punctuation">(</span>iix<span class="token punctuation">,</span>iiy<span class="token punctuation">)</span><span class="token operator">/</span>rexist<span class="token punctuation">(</span>iix<span class="token punctuation">,</span>iiy<span class="token punctuation">)</span><span class="token operator">-</span>stime<span class="token punctuation">)</span> <span class="token operator">.le.</span> <span class="token number">0.2</span><span class="token punctuation">)</span> <span class="token keyword">then</span>				   
			    <span class="token keyword">do</span> ik<span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span>
		       mcwp<span class="token punctuation">(</span>ik<span class="token punctuation">)</span> <span class="token operator">=</span> fcwp<span class="token punctuation">(</span>iix<span class="token punctuation">,</span>iiy<span class="token punctuation">,</span>ik<span class="token punctuation">)</span>	     
	           mctt<span class="token punctuation">(</span>ik<span class="token punctuation">)</span> <span class="token operator">=</span> fctt<span class="token punctuation">(</span>iix<span class="token punctuation">,</span>iiy<span class="token punctuation">,</span>ik<span class="token punctuation">)</span>
	           mctp<span class="token punctuation">(</span>ik<span class="token punctuation">)</span> <span class="token operator">=</span> fctp<span class="token punctuation">(</span>iix<span class="token punctuation">,</span>iiy<span class="token punctuation">,</span>ik<span class="token punctuation">)</span>
               mfrc<span class="token punctuation">(</span>ik<span class="token punctuation">)</span> <span class="token operator">=</span> frc <span class="token punctuation">(</span>iix<span class="token punctuation">,</span>iiy<span class="token punctuation">,</span>ik<span class="token punctuation">)</span> 
		        <span class="token keyword">end do</span>		   
		     .....
        <span class="token keyword">end if</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li><p>åŒæ ·çš„ï¼Œæ‰€åœ¨æ ¼ç‚¹å¿…é¡»åŒ…å«é™æ°´ä¿¡æ¯ï¼Œä¸”æ²¡æœ‰é™æ°´å‘ç”Ÿï¼š</p> <p><code>rexist(iix,iiy).ne.0 .and. rainflag(iix,iiy).eq.0</code>ï¼›</p></li> <li><p>æ‰€åœ¨æ ¼ç‚¹çš„é™æ°´è§‚æµ‹å’Œäº‘è§‚æµ‹å’Œäº®æ¸©è§‚æµ‹å¿…é¡»åœ¨åŒä¸€è½¨é“ä¸Šï¼Œä½¿ç”¨è§‚æµ‹æ—¶é—´é™å®š:</p> <p><code>abs(rtime(iix,iiy)/rexist(iix,iiy)-stime) .le. 0.2</code>ï¼›</p></li> <li><p>å¯¹6ä¸ªç›¸æ€çš„äº‘å‚æ•°è¿›è¡Œèµ‹å€¼ã€‚</p></li></ul></li> <li><p>å¯¹é€æ¡å¯¼å…¥çš„AE-L2Aæ•°æ®å…ƒè¿›è¡Œå†åˆ†ææ•°æ®çš„åŒ¹é…ï¼š</p> <p>åœ¨ç¬¬5æ­¥ä¸­ï¼ŒERA20Cçš„èµ„æ–™åœºå·²ç»å¯¼å…¥å®Œæ¯•ï¼Œç°åœ¨åªéœ€è¦ç¡®å®šäº®æ¸©æ•°æ®åœ¨EC0.125<sup>o</sup>ç½‘æ ¼ä¸Šçš„ä¸‹æ ‡å’Œæ—¶é—´ã€‚</p> <ul><li><p><strong>ç¡®å®šä¸‹æ ‡</strong>ï¼š</p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>  ilon <span class="token operator">=</span> nint<span class="token punctuation">(</span><span class="token punctuation">(</span>lon<span class="token operator">-</span> minlon<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">0.125</span><span class="token punctuation">)</span> 
  ilat <span class="token operator">=</span> nint<span class="token punctuation">(</span><span class="token punctuation">(</span>maxlat<span class="token operator">-</span> lat<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">0.125</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p><strong>ç¡®å®šæ—¶é—´</strong></p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>           it <span class="token operator">=</span> int<span class="token punctuation">(</span><span class="token punctuation">(</span>stime <span class="token operator">-</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3.0</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>       
         	  hr1<span class="token operator">=</span><span class="token punctuation">(</span>it<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3.0</span>          <span class="token comment">! 0:00-21:00</span>
         	  hr2<span class="token operator">=</span>hr1<span class="token operator">+</span><span class="token number">3.0</span>             <span class="token comment">! 3:00 - 24:00</span>
     
              wt1<span class="token operator">=</span><span class="token punctuation">(</span>hr2<span class="token operator">-</span>stime<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3.</span>   <span class="token comment">!weight</span>
        	  wt2<span class="token operator">=</span><span class="token punctuation">(</span>stime<span class="token operator">-</span>hr1<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3.</span>
     	      ih1<span class="token operator">=</span>it
     	      ih2<span class="token operator">=</span>it<span class="token operator">+</span><span class="token number">1</span>
	        <span class="token keyword">if</span> <span class="token punctuation">(</span>ih2<span class="token operator">.eq.</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
			   ih2 <span class="token operator">=</span> <span class="token number">1</span>   <span class="token comment">! not actually ...should use 00:00 of the next day,but stime usually less than 10:00 in east-asia</span>
			 <span class="token keyword">end if</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>æˆ‘ä»¬éœ€è¦çš„ih1å’Œih2æ˜¯stimeæ‰€åœ¨çš„ä¸¤ä¸ª3å°æ—¶é—´éš”ä¸‹æ ‡ï¼Œæ¯”å¦‚ stime=1:30ï¼Œå¯¹åº”çš„ih1=1ï¼Œih2=2; stime=7:15ï¼Œå¯¹åº”çš„ih1=3ï¼Œih2=4ã€‚æ³¨æ„ï¼Œæœ¬å¥—æ•°æ®åæ¼”è¿‡ç¨‹ä¸­æ‰€æœ‰çš„æ—¶é—´å‡ä¸ºç»Ÿä¸€çš„UTCæ—¶é—´ï¼Œä¸éœ€è¦ä»»ä½•è½¬åŒ–ï¼Œä¸Šè¡Œè½¨Aquaåœ¨åˆååœ°æ–¹æ—¶çš„13:30å·¦å³ï¼Œä¸å­˜åœ¨stimeåœ¨21:00å’Œæ¬¡æ—¥0:00ä¹‹é—´çš„å¤æ‚æƒ…å½¢ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½¿ç”¨GPMè¿™ç§éå¤ªé˜³åŒæ­¥å«æ˜Ÿï¼Œå°±è¦è€ƒè™‘è¿™ç§é—®é¢˜ã€‚</p></li> <li><p><strong>æŠ½å–æ•°æ®å¹¶åšæƒé‡å¹³å‡</strong></p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>  skp<span class="token operator">=</span>wt1<span class="token operator">*</span>psurf<span class="token punctuation">(</span>ilon<span class="token punctuation">,</span>ilat<span class="token punctuation">,</span>ih1<span class="token punctuation">)</span> <span class="token operator">+</span> wt2<span class="token operator">*</span>psurf<span class="token punctuation">(</span>ilon<span class="token punctuation">,</span>ilat<span class="token punctuation">,</span>ih2<span class="token punctuation">)</span>
 <span class="token comment">!è¿™é‡Œä»¥æ—¶é—´åœ°è¡¨æ°”å‹ä¸ºä¾‹ï¼Œæ³¨æ„ï¼Œæƒé‡WT1å’ŒWT2è¦ä¸æåäº†</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>ä¾‹å¤–</strong>ï¼Œå‚æ•°2mæ¸©åº¦t2mæ˜¯æ¯6å°æ—¶ä¸€æ¬¡æ•°æ®ï¼Œæ‰€ä»¥è¦ç‰¹åˆ«å¤„ç†ï¼Œè™½ç„¶åæ¼”è¿‡ç¨‹ä¸éœ€è¦è¿™ä¸ªå‚æ•°ï¼Œä½†æ˜¯æœªæ¥å¯ä»¥ç”¨æ¥å’Œåœ°åŸºç«™ç‚¹åšLSTæ ¡æ­£ï¼š</p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>            itt <span class="token operator">=</span> int<span class="token punctuation">(</span><span class="token punctuation">(</span>stime <span class="token operator">-</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">6.0</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>       
         	  hr11<span class="token operator">=</span><span class="token punctuation">(</span>itt<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">6.0</span>          <span class="token comment">! 0:00-21:00</span>
         	  hr22<span class="token operator">=</span>hr11<span class="token operator">+</span><span class="token number">6.0</span>             <span class="token comment">! 6:00 - 24:00</span>
     
             wt11<span class="token operator">=</span><span class="token punctuation">(</span>hr22<span class="token operator">-</span>stime<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">6.</span>   <span class="token comment">!weight</span>
        	 wt22<span class="token operator">=</span><span class="token punctuation">(</span>stime<span class="token operator">-</span>hr11<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">6.</span>
     	      ih11<span class="token operator">=</span>itt
     	      ih22<span class="token operator">=</span>itt<span class="token operator">+</span><span class="token number">1</span>
	        <span class="token keyword">if</span> <span class="token punctuation">(</span>ih22<span class="token operator">.eq.</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
			   ih22 <span class="token operator">=</span> <span class="token number">1</span>   
			   <span class="token keyword">end if</span>
			  
<span class="token comment">!!!!        Lagrange Interpolation</span>
            t2m<span class="token operator">=</span>wt11<span class="token operator">*</span>t2mg<span class="token punctuation">(</span>ilon<span class="token punctuation">,</span>ilat<span class="token punctuation">,</span>ih11<span class="token operator">*</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>wt22<span class="token operator">*</span>t2mg<span class="token punctuation">(</span>ilon<span class="token punctuation">,</span>ilat<span class="token punctuation">,</span>ih22<span class="token operator">*</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>		 	 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li></ul></li> <li><p>æ ¹æ®äº‘ç±»å‹è®¾ç½®æ°´å‡ç‰©å‚æ•°<code>CldWtr CldIce</code>ï¼Œè¿™ä¸€éƒ¨åˆ†è¾ƒä¸ºå¤æ‚è€Œä¸”ä¹±ï¼Œæœ‰æ—¶é—´å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹ï¼Œä½†æ˜¯æ”¹åŠ¨çš„è¯æå®¹æ˜“å‡ºé”™ã€‚å¦å¤–åœ¨å½’ç±»æ–¹æ¡ˆä¸Šæœ‰å¾…å•†æ¦·ï¼Œè¿™ä¸€éƒ¨åˆ†ä¼šå½±å“åˆ°æ•°æ®æ ·æœ¬çš„æœ‰æ•ˆæ€§é—®é¢˜ï¼Œä¼šæœ‰å¾ˆå¤šæ¡ä»¶åˆ¤æ–­èˆå¼ƒå¾ˆå¤šæ ·æœ¬ã€‚ä½†æ˜¯é€»è¾‘æ–¹é¢æ²¡æœ‰é—®é¢˜ã€‚æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™ä¸€éƒ¨åˆ†ï¼š</p> <p><strong>MWSIMæ°´å‡ç‰©è®¾ç½®è¯´æ˜</strong></p> <p>åœ¨æ­¤ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆäº†è§£ä¸€ä¸‹<a href="https://jihenghu.github.io/pdfs/mwsim-cloud-study.pdf" target="_blank" rel="noopener noreferrer">MWSIMæ¨¡å¼å¯¹äºæ°´å‡ç‰©å»“çº¿çš„ä½¿ç”¨è¯´æ˜<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ï¼Œè§é™„å½•ã€‚</p> <p>è¿™é‡Œå¯èƒ½éœ€è¦è¡¥ä¹ ä¸€ä¸‹å¤§æ°”ç‰©ç†ä¸­çš„äº‘ç‰©ç†çŸ¥è¯†ï¼Œäº‘æ»´è°±ï¼Œé›¨æ»´è°±åˆ†å¸ƒã€‚è¿™æ˜¯æˆ‘çš„è®¾ç½®ï¼Œå‚è€ƒäº†éƒ­é™è¶…ä½¿ç”¨çš„wrfäº‘å‚æ•°åŒ–æ–¹æ¡ˆï¼š<img src="https://ws1.sinaimg.cn/large/005zDzHply1g4ly0a56puj311l0l9whz.jpg"></p> <hr> <p><strong>ä»£ç è¯´æ˜</strong></p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>  newl <span class="token operator">=</span> min<span class="token punctuation">(</span>count<span class="token punctuation">(</span>rh<span class="token operator">.ge.</span><span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> count<span class="token punctuation">(</span>z<span class="token operator">.ge.</span><span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>count<span class="token punctuation">(</span>tk<span class="token operator">.ge.</span><span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">!!!è®¡ç®—åœ°å½¢ä»¥ä¸Šçš„æœ‰æ•ˆå±‚æ•°</span>
  <span class="token comment">!!!åˆå§‹åŒ–   CldWtr=0 ,CldIce=0</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>mcwp<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">.ne.</span> <span class="token number">0.0</span> <span class="token punctuation">)</span>  <span class="token keyword">goto</span> <span class="token number">176</span> <span class="token comment">!!!ç¬¬6ç§åˆ†ç±»ä¸ä¸º0ï¼Œä¸å¯èƒ½ã€‚èˆå¼ƒæ ·æœ¬</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>   <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>mcwp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> mcwp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span> mcwp<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.ne.</span> <span class="token number">0.0</span> <span class="token punctuation">)</span> <span class="token keyword">then</span>            
       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mctp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>mctp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span>mctp<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.eq.</span><span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
       	   <span class="token keyword">print</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token string">&quot;type 1 cwp/ctp unmatch-------&quot;</span><span class="token punctuation">,</span>ip  		
           <span class="token keyword">goto</span> <span class="token number">176</span>
       <span class="token keyword">endif</span>
    <span class="token keyword">end if</span>
<span class="token comment">!!!å¦‚æœç±»1,2,3æ€»å’Œä¸ä¸º0ï¼Œä½†æ˜¯äº‘é¡¶æ°”å‹éƒ½ä¸º0ï¼ˆç¼ºæµ‹ï¼‰ï¼Œèˆå¼ƒ</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>æ¶²æ€æ°´äº‘</li></ul> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code> <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>mcwp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> mcwp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span> mcwp<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.ne.</span> <span class="token number">0.0</span> <span class="token punctuation">)</span> <span class="token keyword">then</span> 
 .......
 <span class="token comment">!!!! mcwp1	  å¤„ç†ç¬¬1ç§ç±»å‹ï¼Œä¹Ÿå°±æ˜¯æ¶²æ€æ°´äº‘  </span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>mctp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">.gt.</span> pmb<span class="token punctuation">(</span>newl<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">then</span>   
     <span class="token comment">!!å¦‚æœäº‘é¡¶æ°”å‹é«˜äºæœ€åº•å±‚æ°”å‹ï¼ŒæŠŠäº‘æ”¾ç½®åœ¨æœ€åº•å±‚newl</span>
         CldWtr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> CldWtr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>mcwp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>z<span class="token punctuation">(</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>z<span class="token punctuation">(</span>newl<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token comment">!!!è®¡ç®—äº‘æ°´å«é‡å¹¶èµ‹å€¼åˆ°æ°´å‡ç‰©å»“çº¿ä¸Šçš„newl-1å±‚å¤„ã€‚</span>
			      CldWtr<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.0</span>   <span class="token comment">!!!!</span>
			      CldWtr<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3.E+5</span>
			      CldWtr<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>
			      CldWtr<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>
	              qc <span class="token operator">=</span> <span class="token number">1</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mctp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">.le.</span> pmb<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">.and.</span> mctp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">.gt.</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">then</span> 
	  <span class="token comment">!!!å¦‚æœäº‘å±‚è¿‡é«˜ï¼Œèˆå¼ƒï¼Œæ‰€ä»¥å»ºè®®ä¿ç•™å…¨éƒ¨37å±‚å»“çº¿ï¼Œè¿™ç§æ ·æœ¬å¾ˆå°‘ã€‚   </span>
			       <span class="token keyword">goto</span> <span class="token number">176</span>		   	 
      <span class="token keyword">else</span> <span class="token comment">!!!å¦‚æœäº‘å±‚åœ¨eraå»“çº¿çš„æŸä¸€å±‚ã€‚</span>
		 <span class="token keyword">do</span> il <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>newl <span class="token operator">-</span><span class="token number">1</span>  <span class="token comment">!!!å¯¹å±‚è¿›è¡Œå¾ªç¯ï¼Œç¡®å®šäº‘æ‰€åœ¨å±‚ï¼Œè‡ªé¡¶å‘ä¸‹ï¼Œ1ä¸ºæœ€é«˜å±‚</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span> mctp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">.gt.</span> pmb<span class="token punctuation">(</span>il<span class="token punctuation">)</span> <span class="token operator">.and.</span> mctp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">.le.</span> pmb<span class="token punctuation">(</span>il<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">then</span> 			                 <span class="token comment">!!!è¿™é‡Œä½¿ç”¨çš„æ˜¯æ°”å‹å»“çº¿æ¥å¯¹äº‘å®šä½ï¼Œå»ºè®®ä»¥åç”¨é«˜åº¦å»“çº¿ï¼Œç»å¯¹å•è°ƒé€’å‡			     </span>
		      CldWtr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">=</span> CldWtr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">+</span> mcwp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>z<span class="token punctuation">(</span>il<span class="token punctuation">)</span><span class="token operator">-</span>z<span class="token punctuation">(</span>il<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		      <span class="token comment">!!!è®¡ç®—äº‘æ°´å«é‡å¹¶èµ‹å€¼åˆ°æ°´å‡ç‰©å»“çº¿ä¸Šçš„ilå±‚å¤„ã€‚</span>
			          CldWtr<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.0</span>
			          CldWtr<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3.E+5</span>
			          CldWtr<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>
			          CldWtr<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>	                				  
	            <span class="token keyword">exit</span> <span class="token comment">!æ‰¾åˆ°æ‰€åœ¨å±‚å°±è·³å‡ºå¾ªç¯</span>
		     <span class="token keyword">end if</span> 
	     <span class="token keyword">end do</span>
	  <span class="token keyword">end if</span>	 
 <span class="token keyword">end if</span>
   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><ul><li><p>å†°æ€æ°´äº‘</p> <p>å’Œæ¶²æ€æ°´äº‘ç±»ä¼¼ï¼Œåªä¸è¿‡éœ€è¦å¯¹å†°æ™¶è°±è¿›è¡Œè®¾ç½®ï¼š</p></li></ul> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code> <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>mcwp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> mcwp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span> mcwp<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.ne.</span> <span class="token number">0.0</span> <span class="token punctuation">)</span> <span class="token keyword">then</span> 
 .......
<span class="token comment">!!! mcwp2		   </span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>mctp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">.gt.</span> pmb<span class="token punctuation">(</span>newl<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">then</span>                  
            CldIce<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>CldIce<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>mcwp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>z<span class="token punctuation">(</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>z<span class="token punctuation">(</span>newl<span class="token punctuation">)</span><span class="token punctuation">)</span>  
			          CldIce<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>newl <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.0</span>		          
			          CldIce<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>newl <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2.55E+3</span>    
			          CldIce<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span>newl <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>         
			          CldIce<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span>newl <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>         
			          CldIce<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span>newl <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">8</span>          
          <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mctp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">.le.</span> pmb<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">.and.</span> mctp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">.gt.</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
<span class="token comment">!           print*,&quot;type 3 ctp2 overlow--&quot;,mctp(2),pmb(1),&quot;-------&quot;,ip				   </span>
			       <span class="token keyword">goto</span> <span class="token number">176</span>
          <span class="token keyword">else</span> 
              <span class="token keyword">do</span> il <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>newl <span class="token operator">-</span><span class="token number">1</span>
                  <span class="token keyword">if</span><span class="token punctuation">(</span> mctp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">.gt.</span> pmb<span class="token punctuation">(</span>il<span class="token punctuation">)</span> <span class="token operator">.and.</span> mctp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">.le.</span> pmb<span class="token punctuation">(</span>il<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">then</span> 		
                      CldIce<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">=</span> CldIce<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">+</span> mcwp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>z<span class="token punctuation">(</span>il<span class="token punctuation">)</span><span class="token operator">-</span>z<span class="token punctuation">(</span>il<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                      CldIce<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.0</span>		          
                      CldIce<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2.55E+3</span>    
                      CldIce<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>         
                      CldIce<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>         
                      CldIce<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span>il<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">8</span>                         					  
                      <span class="token keyword">exit</span> 
                  <span class="token keyword">end if</span> 
              <span class="token keyword">end do</span>
		 <span class="token keyword">end if</span>	 
 <span class="token keyword">end if</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ul><li><p>æ··åˆæ€ï¼ˆik=3ï¼‰</p> <p>æ··åˆæ€çš„å¤„ç†æ–¹æ³•æ˜¯ä¸€åŠæ°´ä¸€åŠå†°ï¼Œå¤„ç†æ–¹æ³•å’Œå‰ä¸¤ä¸ªç±»ä¼¼ï¼š</p></li></ul> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>mcwp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> mcwp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span> mcwp<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.ne.</span> <span class="token number">0.0</span> <span class="token punctuation">)</span> <span class="token keyword">then</span> 
 .......
<span class="token comment">!!!mcwp3	   </span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mctp<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">.gt.</span> pmb<span class="token punctuation">(</span>newl<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">then</span> 
        cic <span class="token operator">=</span> cic <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>mcwp<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
        cwc <span class="token operator">=</span> cwc <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>mcwp<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

        CldWtr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>CldWtr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>mcwp<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>z<span class="token punctuation">(</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>z<span class="token punctuation">(</span>newl<span class="token punctuation">)</span><span class="token punctuation">)</span>  
        CldWtr<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.0</span>
        CldWtr<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3.E+5</span>
        CldWtr<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>
        CldWtr<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>

        CldIce<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> CldIce<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>mcwp<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>z<span class="token punctuation">(</span>newl<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>z<span class="token punctuation">(</span>newl<span class="token punctuation">)</span><span class="token punctuation">)</span>    
        CldIce<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>newl <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.0</span>		          
        CldIce<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>newl <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2.55E+3</span>    
        CldIce<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span>newl <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>         
        CldIce<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span>newl <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>         
        CldIce<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span>newl <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">8</span>  
    <span class="token keyword">else</span> <span class="token keyword">if</span> 
    ....
    <span class="token keyword">end if</span>
<span class="token keyword">end if</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><ul><li>uncertain or FillValue ï¼ˆik=5ï¼‰</li></ul> <p>å¤„ç†æ–¹å¼å’Œæ··åˆæ€ï¼ˆik=3ï¼‰ç›¸åŒã€‚</p> <ul><li><p>æœ€åä¸€ç§æ˜¯æ™´ç©ºï¼ˆik=4ï¼‰  <code>CldWtr=0 ,CldIce=0</code></p></li> <li><p>QC</p> <p>è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªqcï¼Œç”¨æ¥è¡¨ç¤ºäº‘ç±»å‹</p> <table><thead><tr><th>qc</th> <th>1</th> <th>2</th> <th>3</th> <th>4</th> <th>0</th></tr></thead> <tbody><tr><td>è¯´æ˜</td> <td>æ¶²æ€æ°´</td> <td>å†°æ€æ°´</td> <td>mixed</td> <td>uncertain</td> <td>æ™´ç©º</td></tr></tbody></table> <p>ç”±äºäº‘ä¿¡æ¯æ˜¯åŒºåŸŸå¹³å‡çš„ï¼Œæ‰€ä»¥æ¯ä¸ªäº®æ¸©æ ·æœ¬åŒ¹é…çš„äº‘å¯ä»¥ä¸æ­¢ä¸€ç§ç›¸æ€ï¼Œæ‰€ä»¥ï¼Œä¸åŒçš„ç›¸æ€ä¼šåˆ†å¸ƒåœ¨ä¸åŒçš„é«˜åº¦ï¼Œæœ‰ç€ä¸åŒçš„æ°´å«é‡ï¼Œè¿™å°±æ˜¯MWRTä½¿ç”¨æ°´å‡ç‰©å»“çº¿çš„æ„ä¹‰ã€‚è™½ç„¶ä¸€æœµäº‘åªèƒ½å‹ç¼©åœ¨ä¸€å±‚ä¸­ï¼Œä½†æ˜¯ä¸åŒç›¸æ€çš„äº‘å¯ä»¥åˆ†å¸ƒåœ¨ä¸åŒçš„é«˜åº¦å±‚ä¸Šé¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰çš„äº®æ¸©æ ·æœ¬å¯èƒ½åŒæ—¶ç»å†äº†ä¸Šé¢çš„è‹¥å¹²ç§å¤„ç†æ–¹æ³•ï¼Œå¾—åˆ°ä¸€æ¡ä¸°å¯Œçš„åŒ…å«å„ä¸ªç›¸æ€çš„æ°´å‡ç‰©å»“çº¿ã€‚è¿™å°±æ˜¯mixedç±»å‹å’Œuncertainç±»å‹å¼•èµ·çš„ã€‚</p> <p>ä¸‹é¢æ˜¯äº‘é«˜å®šä½å’Œæ±‚ç®—æ°´å‡ç‰©å»“çº¿çš„ç¤ºæ„å›¾ï¼š</p> <img src="https://ws1.sinaimg.cn/large/005zDzHply1g4ly510vfkj315v0hhq4c.jpg"></li></ul></li></ol> <hr> <h2 id="å»ºè®®"><a href="#å»ºè®®" class="header-anchor">#</a> - å»ºè®®</h2> <ul><li><p>å¦‚æœé‡æ–°åšè¿™å¥—æ•°æ®ï¼Œå»ºè®®ä½¿ç”¨res1äº‘çš„EFOVå¹³å‡å°ºå¯¸ä¸º44=sqrt(piX25X25) kmï¼Œæ‰€ä»¥ç”¨9X9æ ¼ç‚¹å°±å¤Ÿäº†</p> <p>ä¹Ÿå°±æ˜¯:</p> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>  <span class="token keyword">do</span> i <span class="token operator">=</span> icx<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span>icx<span class="token operator">+</span><span class="token number">4</span>
	     <span class="token keyword">do</span> j <span class="token operator">=</span> icy <span class="token operator">-</span><span class="token number">4</span> <span class="token punctuation">,</span>icy <span class="token operator">+</span><span class="token number">4</span>
             <span class="token keyword">if</span><span class="token punctuation">(</span>rainflag<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span> <span class="token operator">.gt.</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">cycle</span>		 
.....
      <span class="token keyword">end do</span>
   <span class="token keyword">end do</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ul> <h2 id="é™„å½•"><a href="#é™„å½•" class="header-anchor">#</a> -é™„å½•</h2> <ul><li>MWSIMæ°´å‡ç‰©è®¾ç½®è¯´æ˜ï¼Œæ¥æºäºmwsimæ¨¡å¼æºä»£ç <code>radsub.f</code></li></ul> <div class="language-fortran line-numbers-mode"><pre class="language-fortran"><code>C for hydrometeors<span class="token punctuation">,</span> always assume gamma psd<span class="token punctuation">,</span> i<span class="token operator">.e.</span><span class="token punctuation">,</span>
C   N<span class="token punctuation">(</span>D<span class="token punctuation">)</span> <span class="token operator">=</span> N0<span class="token operator">*</span>D<span class="token operator">**</span>mu<span class="token operator">*</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>lambda<span class="token operator">*</span>D<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">where</span> D is diameter <span class="token keyword">in</span> m<span class="token punctuation">,</span> and 
C          N<span class="token punctuation">(</span>D<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">/</span>m^<span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">+</span>mu<span class="token punctuation">)</span>
C <span class="token operator">**</span><span class="token operator">**</span><span class="token operator">*</span> CAN <span class="token keyword">ONLY</span> GIVEN TWO of the THREE<span class="token punctuation">:</span> N0<span class="token punctuation">,</span> lambda and water content
C CldWtr<span class="token punctuation">:</span>						CldWtr<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span>L<span class="token punctuation">)</span>
C  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">-</span> cloud liquid water content <span class="token punctuation">(</span>WC<span class="token punctuation">)</span> <span class="token keyword">in</span> g<span class="token operator">/</span>m^<span class="token number">3</span>
C  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">-</span> N0 <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">/</span>m^<span class="token number">4</span>
C  <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">-</span> Lambda <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">/</span>m
C  <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">-</span> mu <span class="token keyword">in</span> psd <span class="token punctuation">(</span>mu<span class="token operator">=</span><span class="token number">0</span> is exponential<span class="token punctuation">)</span>
C  <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0</span><span class="token punctuation">:</span> no cloud water<span class="token punctuation">;</span> <span class="token number">1</span><span class="token punctuation">:</span> know N0 and WC<span class="token punctuation">;</span> 
C          <span class="token number">2</span><span class="token punctuation">:</span> know lambda and WC<span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">:</span> know N0 and lambda
C          <span class="token number">4</span><span class="token punctuation">:</span> know N and WC for monosized cloud drops<span class="token punctuation">,</span> N0 will be N <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">/</span>m^<span class="token number">3</span>
C          <span class="token number">5</span><span class="token punctuation">:</span> know D<span class="token punctuation">(</span>iameter<span class="token punctuation">,</span> <span class="token keyword">in</span> um<span class="token punctuation">)</span> and WC for monosized<span class="token punctuation">,</span> LAM will be D <span class="token keyword">in</span> um
C	   <span class="token number">6</span><span class="token punctuation">:</span> know N and D <span class="token punctuation">(</span><span class="token keyword">use</span> N0 and LAM<span class="token punctuation">)</span> for monosized cloud drops
C             N <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">/</span>m^<span class="token number">3</span><span class="token punctuation">,</span> D <span class="token keyword">in</span> um
C   <span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span> when giving D<span class="token punctuation">,</span> please <span class="token keyword">use</span> even number <span class="token punctuation">(</span>so that radius will be an <span class="token keyword">integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
C          otherwise<span class="token punctuation">,</span> it will be rounded to the nearest even number internally
C          <span class="token keyword">in</span> the <span class="token keyword">program</span>.   <span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">*</span>


C CldIce<span class="token punctuation">:</span>						CldIce<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span>L<span class="token punctuation">)</span>
C  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">-</span> cloud ice water content <span class="token punctuation">(</span>WC<span class="token punctuation">)</span> <span class="token keyword">in</span> g<span class="token operator">/</span>m^<span class="token number">3</span>
C  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">-</span> N0 <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">/</span>m^<span class="token number">4</span>
C  <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">-</span> Lambda <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">/</span>m
C  <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">-</span> mu <span class="token keyword">in</span> psd <span class="token punctuation">(</span>mu<span class="token operator">=</span><span class="token number">0</span> is exponential<span class="token punctuation">)</span>
C  <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0</span><span class="token punctuation">:</span> no cloud ice water<span class="token punctuation">;</span> 
C          <span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span> D <span class="token keyword">in</span> PSD is melted diameter<span class="token punctuation">;</span> <span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">:</span> D <span class="token keyword">in</span> PSD is actual diameter
C          abs<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span> know N0 and WC<span class="token punctuation">,</span> lambda will be output<span class="token punctuation">;</span> 
C          abs<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span> know lambda and WC<span class="token punctuation">,</span> N0 will be output<span class="token punctuation">;</span> 
C          abs<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">:</span> know N0 and lambda<span class="token punctuation">,</span> WC will be output
C          <span class="token number">4</span><span class="token punctuation">:</span> know N and WC for monosized cloud ice particles<span class="token punctuation">,</span> N0 will be N <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">/</span>m^<span class="token number">3</span>
C          <span class="token number">5</span><span class="token punctuation">:</span> know D<span class="token punctuation">(</span>iameter<span class="token punctuation">,</span> <span class="token keyword">in</span> um<span class="token punctuation">)</span> and WC for monosized<span class="token punctuation">,</span> LAM will be D <span class="token keyword">in</span> um
C          <span class="token number">6</span><span class="token punctuation">:</span> know N and D <span class="token punctuation">(</span><span class="token keyword">use</span> N0 and LAM<span class="token punctuation">)</span> for monosized cloud ice particles
C             N <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">/</span>m^<span class="token number">3</span><span class="token punctuation">,</span> D <span class="token keyword">in</span> um 
C     Note<span class="token punctuation">:</span> options <span class="token number">4</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span> can <span class="token keyword">only</span> work for spheres
C  <span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span> when giving D<span class="token punctuation">,</span> please <span class="token keyword">use</span> even number <span class="token punctuation">(</span>so that radius will be an <span class="token keyword">integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
C         otherwise<span class="token punctuation">,</span> it will be rounded to the nearest even number internally
C         <span class="token keyword">in</span> the <span class="token keyword">program</span>.   <span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">*</span>
C  <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">-</span> ice shape or density <span class="token keyword">in</span> g<span class="token operator">/</span>cm^<span class="token number">3</span>
C          <span class="token keyword">if</span><span class="token operator">&gt;=</span><span class="token number">0</span> ice shape no <span class="token keyword">in</span> scatdb<span class="token punctuation">,</span> <span class="token keyword">if</span><span class="token operator">&lt;</span><span class="token number">0</span> its absolute value is density
C          for monosized cloud ice particles<span class="token punctuation">,</span> must set <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span> <span class="token punctuation">(</span>spheres<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><hr> <p>Â©jihenghu 2019</p></div> <footer class="page-edit" style="display:none;"><div class="edit-link"><a href="https://github.com/jihenghu/jihenghu.github.io/edit/master/docs/document/mlse-ae/collocate.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µï¼</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <!----> <!----> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-40a3448a><li class="level-2" data-v-40a3448a><a href="/document/mlse-ae/collocate.html#æ–‡ä»¶å¤¹å†…å®¹" class="sidebar-link" data-v-40a3448a>- æ–‡ä»¶å¤¹å†…å®¹</a></li><li class="level-2" data-v-40a3448a><a href="/document/mlse-ae/collocate.html#è¿è¡Œæ–¹å¼" class="sidebar-link" data-v-40a3448a>- è¿è¡Œæ–¹å¼</a></li><li class="level-2" data-v-40a3448a><a href="/document/mlse-ae/collocate.html#ä¸Šæ¸¸æ•°æ®é›†" class="sidebar-link" data-v-40a3448a>- ä¸Šæ¸¸æ•°æ®é›†</a></li><li class="level-2" data-v-40a3448a><a href="/document/mlse-ae/collocate.html#è¾“å‡ºè¯´æ˜" class="sidebar-link" data-v-40a3448a>- è¾“å‡ºè¯´æ˜</a></li><li class="level-2" data-v-40a3448a><a href="/document/mlse-ae/collocate.html#æµç¨‹" class="sidebar-link" data-v-40a3448a>- æµç¨‹</a></li><li class="level-2" data-v-40a3448a><a href="/document/mlse-ae/collocate.html#å»ºè®®" class="sidebar-link" data-v-40a3448a>- å»ºè®®</a></li><li class="level-2" data-v-40a3448a><a href="/document/mlse-ae/collocate.html#é™„å½•" class="sidebar-link" data-v-40a3448a>-é™„å½•</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div></div></div>
    <script src="/assets/js/app.84efe3cb.js" defer></script><script src="/assets/js/3.a3aaa010.js" defer></script><script src="/assets/js/1.f6ff2096.js" defer></script><script src="/assets/js/23.d1a88016.js" defer></script>
  </body>
</html>
