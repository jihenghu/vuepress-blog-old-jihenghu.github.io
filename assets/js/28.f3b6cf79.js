(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{393:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#内容"}},[t._v("- 内容")])]),a("li",[a("a",{attrs:{href:"#运行方式"}},[t._v("- 运行方式")])]),a("li",[a("a",{attrs:{href:"#读取上游数据"}},[t._v("- 读取上游数据")])]),a("li",[a("a",{attrs:{href:"#调用反演子程序"}},[t._v("- 调用反演子程序")])]),a("li",[a("a",{attrs:{href:"#迭代反演"}},[t._v("-迭代反演")])]),a("li",[a("a",{attrs:{href:"#迭代参数设置"}},[t._v("- 迭代参数设置")])]),a("li",[a("a",{attrs:{href:"#数据说明"}},[t._v("- 数据说明")]),a("ul",[a("li",[a("a",{attrs:{href:"#利用fortran读取"}},[t._v("利用fortran读取")])]),a("li",[a("a",{attrs:{href:"#利用ncl读取"}},[t._v("利用NCL读取")])])])]),a("li",[a("a",{attrs:{href:"#附录"}},[t._v("附录")])]),a("li",[a("a",{attrs:{href:"#p-style-text-align-center-amsr-e-反演得到的-mlse-空间分布。个例时间：-2008-年-4-月-26-日。上中下：垂直极化通道，水平极化通道和对应频率的极化差。从左往右：-6-925、-10-65、-18-7、-23-8-和36-5-ghz-p"}},[a("p",{staticStyle:{"text-align":"center"}},[t._v(" AMSR-E 反演得到的 MLSE 空间分布。个例时间： 2008 年 4 月 26 日。上中下：垂直极化通道，水平极化通道和对应频率的极化差。从左往右： 6.925、 10.65、 18.7、 23.8 和\n36.5 GHz ")])])])])]),a("p"),t._v(" "),a("p",[t._v("在经历之前一系列的预处理和融合过程，我们现在终于可以使用辐射传输模式来反演MLSE了。")]),t._v(" "),a("p",[t._v("在此之前，你要去学会安装MWRT模式和最新的MWSIM模式。学习其参数说明和设置，理解源代码的架构和模块。前往MWRT模式安装与使用章节。")]),t._v(" "),a("p",[t._v("所谓反演，就是反向运转MWRT模式，使用天顶亮温反推到地表亮温的过程。因为辐射是从地表发射到天顶被卫星接收的，先在利用卫星的接收来反推到地表，就是这么个过程。")]),t._v(" "),a("h2",{attrs:{id:"内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内容"}},[t._v("#")]),t._v(" - 内容")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("+ data              "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##存储反演最终结果")]),t._v("\n- retrieve.f        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##主反演程序 F77")]),t._v("\n- core-iteration.f  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##核心反演程序，迭代和调用MWRT模式")]),t._v("\n- bash.sh             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##编译retrieve.f 脚本")]),t._v("\n- produce.mlse.exe     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##编译产生的可执行文件")]),t._v("\n- batch.sh             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##批量化脚本")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("hr"),t._v(" "),a("h2",{attrs:{id:"运行方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行方式"}},[t._v("#")]),t._v(" - 运行方式")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("首先进行编译，需要用到MWRT的库函数，如"),a("code",[t._v("bash.sh")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("f95 retrieve.f /home/hjh/mwsim/src/rdcmd.c -L /home/hjh/mwsim/lib/ -lrad -lmwrt -llap -o produce.mlse.exe\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("运行脚本：")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sh")]),t._v(" bash.sh\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("产生可执行文件"),a("code",[t._v("produce.mlse.exe")])]),t._v(" "),a("p",[a("code",[t._v("/home/hjh/mwsim/src/rdcmd.c -L /home/hjh/mwsim/lib/-lrad -lmwrt -llap")]),t._v(" 是连接到MWRT的安装目录的，需要根据自己安装情况修改。")])]),t._v(" "),a("li",[a("p",[t._v("单个日期处理（如2004年1月1日)")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$./produce.mlse.exe "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20040101")]),t._v("\n start\n "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20040101")]),t._v("\n ael2a.ael2b.myd06.era20c.basic.20040101.txt                   "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("\n ael2a.ael2b.myd06.era20c.profile.20040101.txt                 "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("\n ael2a.ael2b.myd06.era20c.hydro.20040101.txt                   "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("read")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20040101")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),t._v(" down "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20040101")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("p",[t._v("运行结果：data文件夹下出现"),a("code",[t._v("mlse.easia.amsre.modis.era.res1.001.20040101.txt")]),t._v("，任务完成。")]),t._v(" "),a("p",[t._v("这个过程运行较慢，大概8个小时到10个小时。")])]),t._v(" "),a("li",[a("p",[t._v("批量日期处理（如20040102~20040103）")]),t._v(" "),a("p",[t._v("使用"),a("code",[t._v("batch.sh")]),t._v("脚本")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sh")]),t._v(" batch.sh "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20040102")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20040103")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20040102")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20040103")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("运行结果：执行日志会出现在同目录下："),a("code",[t._v("20040102-20040103.log")])]),t._v(" "),a("p",[t._v("data文件夹下出现")]),t._v(" "),a("p",[a("code",[t._v("mlse.easia.amsre.modis.era.res1.001.20040102.txt")])]),t._v(" "),a("p",[a("code",[t._v("mlse.easia.amsre.modis.era.res1.001.20040103.txt")])]),t._v(" "),a("p",[t._v("对于批量来说，建议一个月分段跑一个，处理一个月在12-14天左右（0.001精度要求下）。所以建议你后台运行：")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$nohup")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" batch.sh "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20040102")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20040103")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" log.200401 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$jobs")]),t._v(" -l\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("+ "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15669")]),t._v(" Running          "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" batch.sh "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20040102")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20040103")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" log.200401 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##注意检查日志，运行是否正常。")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])])])]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"读取上游数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#读取上游数据"}},[t._v("#")]),t._v(" - 读取上游数据")]),t._v(" "),a("p",[t._v("来自"),a("code",[t._v("collocate.res1/data")]),t._v("文件夹下的:")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("- ael2a.ael2b.myd06.era20c.basic.20040101.txt   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##基本参数")]),t._v("\n- ael2a.ael2b.myd06.era20c.profile.20040101.txt  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##大气廓线")]),t._v("\n- ael2a.ael2b.myd06.era20c.hydro.20040101.txt    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##水凝物廓线   ")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("读取这些数据采用的是将所有的观测样本一次性读取完毕存储在数组中，之后对数组进行循环反演各个点的MLSE，避免频繁的读写阻塞并发进程。")]),t._v(" "),a("p",[t._v("如设置的大数组如下，部分参数：")]),t._v(" "),a("div",{staticClass:"language-fortran line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-fortran"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("real")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" lon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("170000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("170000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("tb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("170000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("stime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("170000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("由于每天的样本数（文件行数）不固定，所以去最大的170000个样本数作为运行空间，足够存下所有观测样本。每次读取完毕记录有效样本数（文件行数）kp，循环反演是只对 1~kp 进行反演。")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"调用反演子程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调用反演子程序"}},[t._v("#")]),t._v(" - 调用反演子程序")]),t._v(" "),a("p",[t._v("对每个观测样本，都会对12个通道进行循环，调用核心反演子程序"),a("code",[t._v("core-iteration.f")]),t._v("的"),a("code",[t._v("core_iteration")]),t._v("函数,在主程序的最末尾用include语句引入：")]),t._v(" "),a("div",{staticClass:"language-fortran line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-fortran"}},[a("code",[t._v("       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("call")]),t._v(" core_iteration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("F"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("newL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("IHV"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("PMB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("newl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("newl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("              RH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("newl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Z"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("newl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lst"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("             CldWtr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("newl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("CldIce"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("newl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("             Rain"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("newl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Snow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("newl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("             Graupel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("newl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("tb0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TW1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TW2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("mlse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     \n     .....\n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("include")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./core-iteration.f'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("hr"),t._v(" "),a("h2",{attrs:{id:"迭代反演"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#迭代反演"}},[t._v("#")]),t._v(" -迭代反演")]),t._v(" "),a("p",[t._v("下面是最核心的迭代反演部分，位于"),a("code",[t._v("core-iteration.f")]),t._v("中，采用的是二分查找算法的思想：")]),t._v(" "),a("div",{staticClass:"language-fortran line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-fortran"}},[a("code",[t._v("            minE "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.75")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!!设置MLSE最小的有效值是0.75")]),t._v("\n            maxE "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.05")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!!设置MLSE最大的有效值是1.05")]),t._v("\n\t   \n\t  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!调用MWRT模式计算minE，maxE对应的天顶亮温 mintb和maxtb")]),t._v("\n\t     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("call")]),t._v("  mwstrm4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("F"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("newL"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("LOUT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("IHV"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("U"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("PMB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("RH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Z"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("IS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("minE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("&")]),t._v("\n            CldWtr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("CldIce"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Rain"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Snow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Graupel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("&")]),t._v("\n            MixingRule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TW1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TW2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("EMISS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("SurfModel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("IO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("retcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t              mintb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \t\t\t  \n\t\t          TB "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CALL")]),t._v(" MWSTRM4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("F"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("newL"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("LOUT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("IHV"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("U"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("PMB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("RH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Z"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("IS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("maxE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("&")]),t._v("\n            CldWtr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("CldIce"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Rain"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Snow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Graupel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("&")]),t._v("\n            MixingRule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TW1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TW2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("EMISS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("SurfModel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("IO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("retcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\t\t   \n                  maxtb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t\t  TB "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br")])]),a("div",{staticClass:"language-fortran line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-fortran"}},[a("code",[t._v("\n minor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" mintb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".ge.")]),t._v(" tb0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!!如果天顶观测亮温小于等于mintb")]),t._v("\n\t\t\t      mde "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.75")]),t._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!就取MLSE=0.75为反演结果")]),t._v("\n\t   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("maxtb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".le.")]),t._v(" tb0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!!如果天顶观测亮温大于等于maxtb")]),t._v("\n\t\t\t\t  mde "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.05")]),t._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!就取MLSE=1.05为反演结果")]),t._v("\n\t   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!如果tb0在（mintb,maxtb）之间，则开始二分迭代查找")]),t._v("\n\t\t\t\t\n           delta_tb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("  \n                             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!模拟输出和天顶亮温之间的相对误差，初始化为1")]),t._v("\n           mdE "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" minE"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("maxE"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("minE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.618")]),t._v("\n                         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!利用0.618的比例计算第一个二分点，作为mlse的猜测值")]),t._v("\n           i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!迭代次数     ")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!! do iteration:   ")]),t._v("\n       inter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("abs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta_tb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".gt.")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.001")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n                           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!如果相对误差小于0.001就结束迭代，满足精度      ")]),t._v("\n\t\t\ti"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" \n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!调用MWRT模式的被动微波传输模块，模拟计算mdE猜测对应的模拟天顶亮温mdtb")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CALL")]),t._v(" MWSTRM4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("F"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("newL"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("LOUT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("IHV"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("U"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("PMB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("RH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Z"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("IS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("mdE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("&")]),t._v("\n               CldWtr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("CldIce"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Rain"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Snow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Graupel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("&")]),t._v("\n               MixingRule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TW1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TW2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("EMISS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("SurfModel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("IO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("retcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\t\n                 mdtb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                  TB "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v("\n    \n\t\t      delta_TB "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tb0"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("mdTB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tb0 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!计算相对误差，作为是否继续迭代的条件")]),t._v("\n\n\t\t\t   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("abs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta_tb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".le.")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.001")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n\t\t\t        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("goto")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("110")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!满足精度跳出,mde输出作为反演结果")]),t._v("\n\t\t\t      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end if")]),t._v("\n\t\t\t      \n\t\t\t   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!不满足精度要求，选取下一个二分点，调整查找区间     ")]),t._v("\n\t\t\t   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mdtb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".lt.")]),t._v(" tb0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("      \n\t\t\t       minE "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mdE\n\t\t\t       mdE  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" minE"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("maxE"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("minE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.618")]),t._v("  \n\t\t\t   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mdtb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".gt.")]),t._v(" tb0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n\t\t\t       maxE "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mdE\n\t\t\t       mdE  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" minE"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("maxE"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("minE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.618")]),t._v(" \n\t\t\t   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mdtb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".eq.")]),t._v(" tb0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n\t\t\t\t   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("goto")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("110")]),t._v("\n\t\t\t   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("endif")]),t._v("\n\t\t\t   \n      \t\t    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!如果迭代次数超过20次就跳出，避免未知原因死循环")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".gt.")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" \n                 \t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end if")]),t._v(" \t\t\t\t\t\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end do")]),t._v(" inter\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("endif")]),t._v(" minor\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("110")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),t._v("\n\t\t     MLSE "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mde   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!跳出迭代后的mde就是满足精度要求的MLSE")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br"),a("span",{staticClass:"line-number"},[t._v("37")]),a("br"),a("span",{staticClass:"line-number"},[t._v("38")]),a("br"),a("span",{staticClass:"line-number"},[t._v("39")]),a("br"),a("span",{staticClass:"line-number"},[t._v("40")]),a("br"),a("span",{staticClass:"line-number"},[t._v("41")]),a("br"),a("span",{staticClass:"line-number"},[t._v("42")]),a("br"),a("span",{staticClass:"line-number"},[t._v("43")]),a("br"),a("span",{staticClass:"line-number"},[t._v("44")]),a("br"),a("span",{staticClass:"line-number"},[t._v("45")]),a("br"),a("span",{staticClass:"line-number"},[t._v("46")]),a("br"),a("span",{staticClass:"line-number"},[t._v("47")]),a("br"),a("span",{staticClass:"line-number"},[t._v("48")]),a("br"),a("span",{staticClass:"line-number"},[t._v("49")]),a("br")])]),a("p",[t._v("注意，如果你要修改，请反复考虑逻辑顺序，容易出错。尤其是多迭代一次，少迭代一次差别很大。")]),t._v(" "),a("p",[t._v("如果你想要更高的MLSE精度，可以将0.001改为0.0001，不过这样很慢很多，迭代次数多很多。")]),t._v(" "),a("p",[t._v("你也可以修改有效MLSE 的范围[0.75,1.05]。")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"迭代参数设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#迭代参数设置"}},[t._v("#")]),t._v(" - 迭代参数设置")]),t._v(" "),a("div",{staticClass:"language-fortran line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-fortran"}},[a("code",[t._v("  \t     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("parameter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("is   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!陆地条件，给定MLSE")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("parameter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("IO   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!双极化输出")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("parameter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOUT "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!天顶层输出")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("parameter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pi   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" acos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!PI=3.1415926......")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("parameter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("U    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("55.0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("pi"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("180.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!!!根据卫星入射角修改：55度")]),t._v("\n         MixingRule "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'EV'")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!冰晶混合模型 equivalent volume solid sphere")]),t._v("\n          SurfModel  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'F'")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!表面模型 fresnel ")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("hr"),t._v(" "),a("h2",{attrs:{id:"数据说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据说明"}},[t._v("#")]),t._v(" - 数据说明")]),t._v(" "),a("div",{staticClass:"language-fortran line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-fortran"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("newl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("qc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MLSEs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("&")]),t._v("\n            cwc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("cic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("tw1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("tw2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lst"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("stime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t2m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("land\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("format")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("I6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v("F12."),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ip   integer型 每个AMSR-E数据点所拥有的唯一ID；  \nnewl integer型 样本对应的大气廓线层数；  \n\nqc   integer型 cloud quality control ：  \n           qc = 0 ;clear sky\n           qc = 1 ; pure water cloud   \n           qc = 2 ; pure ice cloud  \n           qc = 3 ; mixed cloud exist  \n           qc = 4 ; uncertain cloud exist  \n\nlon  float 经度；  \nlat  float 纬度；  \n\ncwc  float 云液态水柱积分 g/cm2  手动计算；  \ncic  float 云冰水柱积分   g/cm2  手动计算；  \ntw1  float 云液态水柱积分 g/cm2  模式输出；  \ntw2  float 云冰水柱积分   g/cm2  模式输出；  \n\nlst  float  地表温度 k；  \nt2m  float  两米温度 k；  \n\nstime  float   扫描时间 hr （UTC）；  \nlandflag  float  陆地分数 0-100；  \n\ntb    float(12) 12个通道天顶亮温观测；  \nmlse  float(12) 12个通道地表微博比辐射率反演结果； \n\ntbsurf 即表面微波亮温计算公式:   tbsurf=LST*MLSE \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br")])]),a("p",[t._v("示例：")]),t._v(" "),a("div",{staticClass:"language-gfortran line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("    27    26     4  143.770706   49.828499    0.979168    0.922625    0.976729    0.927505    0.968834    0.921118    0.966395    0.918678    0.945731    0.898012    0.900451    0.864577  251.710007  237.699997  251.020004  238.710007  249.220001  237.350006  248.490005  237.250000  243.710007  233.589996  233.050003  226.350006    5.158600   35.225201    5.150699   35.212990  256.891815    2.666700  252.000198   94.000000\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("你会发现很多MLSE值是一样的，不要奇怪，根据我们设定的0.001的精度，0.75和1.05之间的迭代次数十分有限，如果亮温差异在3k以内左右，得到的 MLSE很可能是一样的。并且整个MLSE 的取值是离散的，因为在有限次迭代以后，mlse取到的值都是一定的。")]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"利用fortran读取"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#利用fortran读取"}},[t._v("#")]),t._v(" 利用fortran读取")]),t._v(" "),a("div",{staticClass:"language-fortran 77 line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-fortran"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("!! F77(fixed form) code")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("integer")]),t._v("   ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("newl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("qc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("j\n       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("real")]),t._v("      lon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lat\n       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("real")]),t._v("      cwc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("cic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("tw1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("tw2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lst"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t2m\n       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("real")]),t._v("      mlse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("tb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("stime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("landflag \n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1100")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("read")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1101")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("newl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("qc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("               "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mlse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("               cwc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("cic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("tw1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("tw2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lst"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("stime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t2m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("landflag\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("h3",{attrs:{id:"利用ncl读取"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#利用ncl读取"}},[t._v("#")]),t._v(" 利用NCL读取")]),t._v(" "),a("div",{staticClass:"language-ncl line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('    filein="./mlse.land98.res1/mlse.land98.res1.200804"+dd+".txt"      \n     nrows = numAsciiRow(filein); 读取行数\n     ncols = numAsciiCol(filein); 读取列数\n\n     array = asciiread(filein,(/nrows,ncols/),"float") ;  读取数据阵\n     ;分配变量\n     ip    = floattoint(array(:,0)); \n     newl  = floattoint(array(:,2-1)); \n     qc    = floattoint(array(:,3-1));         \n     flon  = array(:,4-1);   \n     flat  = array(:,5-1);   \n     mlse  = array(:,6-1:17-1);   \n     tb    = array(:,18-1:29-1); \n     cwc   = array(:,30-1); \n     cic   = array(:,31-1); \n     tw1   = array(:,32-1); \n     tw2   = array(:,33-1); \n     lst   = array(:,34-1); \n     stime = array(:,35-1); \n     t2m   = array(:,36-1); \n     land  = array(:,37-1); \n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br")])]),a("h2",{attrs:{id:"附录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#附录"}},[t._v("#")]),t._v(" 附录")]),t._v(" "),a("p",[t._v("最终结果")]),t._v(" "),a("img",{attrs:{src:"https://ws1.sinaimg.cn/large/005zDzHply1g4mqxf45haj313308jdm4.jpg"}}),t._v(" "),a("p",{staticStyle:{"text-align":"center"}},[t._v(" lwp iwp lst rain")]),t._v(" "),a("img",{attrs:{src:"https://ws1.sinaimg.cn/large/005zDzHply1g4mr0jp46rj30z90n1as7.jpg"}}),t._v(" "),a("h2",{attrs:{id:"amsr-e-反演得到的-mlse-空间分布。个例时间：-2008-年-4-月-26-日。上中下：垂直极化通道，水平极化通道和对应频率的极化差。从左往右：-6-925、-10-65、-18-7、-23-8-和36-5-ghz"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#amsr-e-反演得到的-mlse-空间分布。个例时间：-2008-年-4-月-26-日。上中下：垂直极化通道，水平极化通道和对应频率的极化差。从左往右：-6-925、-10-65、-18-7、-23-8-和36-5-ghz"}},[t._v("#")]),t._v(" "),a("p",{staticStyle:{"text-align":"center"}},[t._v(" AMSR-E 反演得到的 MLSE 空间分布。个例时间： 2008 年 4 月 26 日。上中下：垂直极化通道，水平极化通道和对应频率的极化差。从左往右： 6.925、 10.65、 18.7、 23.8 和\n36.5 GHz ")])]),t._v(" "),a("p",[t._v("©jihenghu 2019")])])}),[],!1,null,null,null);s.default=e.exports}}]);