(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{258:function(s,a,t){s.exports=t.p+"assets/img/1566465190470.98c6bb3c.png"},311:function(s,a,t){s.exports=t.p+"assets/img/1566549534512.9ce82e94.png"},312:function(s,a,t){s.exports=t.p+"assets/img/1566549556215.8f36c84e.png"},313:function(s,a,t){s.exports=t.p+"assets/img/1566552312953.0a927c30.png"},314:function(s,a,t){s.exports=t.p+"assets/img/1566552402106.d1d1d27d.png"},396:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#概述"}},[s._v("概述")])]),n("li",[n("a",{attrs:{href:"#流程"}},[s._v("- 流程")])]),n("li",[n("a",{attrs:{href:"#数据说明"}},[s._v("- 数据说明")])]),n("li",[n("a",{attrs:{href:"#读取"}},[s._v("- 读取")])]),n("li",[n("a",{attrs:{href:"#附录"}},[s._v("- 附录")]),n("ul",[n("li",[n("a",{attrs:{href:"#反演文件的运行"}},[s._v("- 反演文件的运行")])]),n("li",[n("a",{attrs:{href:"#结果展示"}},[s._v("- 结果展示")])])])])])]),n("p"),s._v(" "),n("h2",{attrs:{id:"概述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[s._v("#")]),s._v(" 概述")]),s._v(" "),n("p",[s._v("到目前为止，反演所需要的数据已经准备完毕。本节主要对最终的反演操作加以说明。")]),s._v(" "),n("p",[s._v("项目的目录是retrieve，结构如下")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("-rwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" hjh hjh   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6833")]),s._v(" Aug "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":18 run.f*     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##主程序，包含数据的读入，反演和输出三部分")]),s._v("\n-rwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" hjh hjh     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("96")]),s._v(" Aug "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":18 bash.sh*    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##引用mwrt库对主程序进行编译")]),s._v("\n-rwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" hjh hjh    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("315")]),s._v(" Aug "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":18 batch.sh*   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##批量处理脚本")]),s._v("\n-rwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" hjh hjh   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3159")]),s._v(" Aug "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":18 core-iteration.f*  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##反演子程序")]),s._v("\ndrwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" hjh hjh   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Aug "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":19 data/       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 输出文件夹")]),s._v("\n-rwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" hjh hjh "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("120403")]),s._v(" Aug "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":18 produce.exe*  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##编译以后的可执行文件")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("运行如下方式见本节附录，基本上与上一版本相同。")]),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#流程"}},[s._v("#")]),s._v(" - 流程")]),s._v(" "),n("ul",[n("li",[s._v("反演主流程的任务是读取全部样本并进行必要的初始化操作。一次性将所有样本读入内存的数据中，反演时对数组进行循环反演，反演结果存储在内存中，等到所有样本反演结束再一次性输出到文件中。相比于从文件中逐行读取样本，边读边写边反演的做法来说，会有很大的内存开销，但是可以最大程度的避免由于频繁读写带来的进程阻塞（CPU和内存完全可以满足高速运算要求，I/O是制约进程的主要原因，因为涉及到磁盘硬件运行），将绝大部分的任务交给CPU进行连续的运算，只在开始和结束的时候进行读写。")])]),s._v(" "),n("p",[n("img",{attrs:{src:t(311),alt:"1566549534512"}})]),s._v(" "),n("p",{staticStyle:{"text-align":"center",color:"darkred"}},[s._v("图 5.1 反演主流程图")]),s._v(" "),n("ul",[n("li",[s._v("反演内核采用的是二分查找的思想进行持续迭代，知道满足0.001（TB相对误差）的精度要求。和第二版的反演相比，本版本的初始猜测区间为[0.7, 1.1]，落在区间外的样本取最近的端点值，第二版的范围是[0.75, 1.05]，虽然同样是无意义的值，但是会影响到产品的统计特征。本版本的迭代分割点是0.5，而上一版本的分割点是0.618黄金分割，有研究表明后者迭代效率要更高。")])]),s._v(" "),n("p",[n("img",{attrs:{src:t(312),alt:"1566549556215"}})]),s._v(" "),n("p",{staticStyle:{"text-align":"center",color:"darkred"}},[s._v("图 5.2 反演内核流程图")]),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"数据说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据说明"}},[s._v("#")]),s._v(" - 数据说明")]),s._v(" "),n("div",{staticClass:"language-fortran line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-fortran"}},[n("code",[s._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("write")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("isw"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("newl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("yyyymmdd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("landflag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("lon"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("lat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MLSEs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("tw1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("lst"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("t2m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("stime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("loct             \n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("format")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("I8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("F16."),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("ip       样本在单条轨道上的序号\nisw      样本所在轨道在当天所有轨道中的序号\nnewl     有效大气廓线层数\nyyyymmdd 样本扫描年月日，可能和文件名中的日期不一致（跨天的轨道）\nlandflag 样本点的表面类型：\n         1 : Ocean, 2 : Sea ice, 3-7 : Decreasing vegetation, \n         8-11 :decreasing snow cover, 12: standing water, \n         13 : land/ocean or water coast, 14 : sea-ice edge, 15 = Land/Ice edge\n\nlon      样本点经度\nlat      样本点纬度\nMLSEs(9) 反演得到的9通道MLSE\ntb(9)    卫星天顶亮温（K）\ntw1      样本点处的云液态水积分（g/m2）\nlst      地表温度（k）\nt2m      2m气温（K）\nstime    样本扫描UTC时间（hr）\nloct     样本扫描地方时间（hr）\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[s._v("示例：")]),s._v(" "),n("div",{staticClass:"language-gfortran line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("882       5         36        20150705     13        125.6229   6.1268       0.8516    0.7891    0.9125    0.8984    0.9063      0.9156     0.9031     0.8875       0.8750      258.0973  240.7902  279.1485  276.1769    283.5199   281.3865   279.0714     285.8336    285.2910  230.7015  300.2792  300.8109    9.0516     17.4265\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("你会发现很多MLSE值是一样的，不要奇怪，根据我们设定的0.001的精度，0.7和1.1之间的迭代次数十分有限，如果亮温差异在3k以内左右，得到的 MLSE很可能是一样的。并且整个MLSE 的取值是离散的，因为在有限次迭代以后，mlse取到的值都是一定的。")]),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"读取"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#读取"}},[s._v("#")]),s._v(" - 读取")]),s._v(" "),n("ul",[n("li",[s._v("利用fortran读取")])]),s._v(" "),n("div",{staticClass:"language-fortran 77 line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-fortran"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("!! F77(fixed form) code")]),s._v("\n       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("integer")]),s._v("   ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("isw"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("newl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("j"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("yyyymmdd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("landflag\n       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("real")]),s._v("      lon"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("lat\n       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("real")]),s._v("      tw1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("lst"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("t2m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("stime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("loct\n       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("real")]),s._v("      MLSEs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("tb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1100")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("read")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1101")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("isw"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("newl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("yyyymmdd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("landflag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("lon"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("lat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MLSEs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("tw1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("lst"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("t2m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("stime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("loct\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("ul",[n("li",[s._v("利用NCL读取")])]),s._v(" "),n("div",{staticClass:"language-ncl line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    filein="./mlse.cn.gmi.h8.erai.001.20150705.txt"      \n     nrows = numAsciiRow(filein); 读取行数\n     ncols = numAsciiCol(filein); 读取列数\n\n     array = asciiread(filein,(/nrows,ncols/),"float") ;  读取数据阵\n     ;分配变量\n     ip        = floattoint(array(:,0)); \n     isw       = floattoint(array(:,1)); \n     newl      = floattoint(array(:,2));  \n     yyyymmdd  = floattoint(array(:,3)); \n     landflag  = floattoint(array(:,4));\n     \n     flon  = array(:,5);   \n     flat  = array(:,6);  \n     \n     mlse  = array(:,7:15);   \n     tb    = array(:,16:24); \n     tw1   = array(:,25); \n     lst   = array(:,26); \n     t2m   = array(:,27);      \n     stime = array(:,28); \n     loct  = array(:,29); \n     \n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("ul",[n("li",[s._v("样本数统计，和collocation结果完全一致")])]),s._v(" "),n("p",[n("img",{attrs:{src:t(258),alt:"1566465190470"}})]),s._v(" "),n("h2",{attrs:{id:"附录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#附录"}},[s._v("#")]),s._v(" - 附录")]),s._v(" "),n("h3",{attrs:{id:"反演文件的运行"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#反演文件的运行"}},[s._v("#")]),s._v(" - 反演文件的运行")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("首先进行编译，需要用到MWRT的库函数，"),n("code",[s._v("bash.sh")]),s._v("内容如下:")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("f95 run.f /home/hjh/mwsim/src/rdcmd.c -L /home/hjh/mwsim/lib/ -lrad -lmwrt -llap -o produce.exe\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("运行脚本：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$sh")]),s._v(" bash.sh\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("产生可执行文件"),n("code",[s._v("produce.exe")])]),s._v(" "),n("p",[n("code",[s._v("/home/hjh/mwsim/src/rdcmd.c -L /home/hjh/mwsim/lib/-lrad -lmwrt -llap")]),s._v(" 是连接到MWRT的安装目录的，需要根据自己安装情况修改。")])]),s._v(" "),n("li",[n("p",[s._v("单个日期处理（如2004年1月1日)")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("$./produce.exe "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20150705")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20150705")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20150705")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20150705")]),s._v("\n  sample "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5680")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1073.1208")]),s._v("    \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("运行结果：data文件夹下出现"),n("code",[s._v("mlse.cn.gmi.h8.erai.001.20150705.txt")]),s._v("，任务完成。")]),s._v(" "),n("p",[s._v("这个过程运行较慢，大概几十分钟到5个小时。")])]),s._v(" "),n("li",[n("p",[s._v("批量日期处理（如20150802~20150803）")]),s._v(" "),n("p",[s._v("使用"),n("code",[s._v("batch.sh")]),s._v("脚本")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$sh")]),s._v(" batch.sh "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20150802")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20150803")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("运行结果：执行日志会出现在同目录下："),n("code",[s._v("20150802-20150803.log")])]),s._v(" "),n("p",[s._v("data文件夹下出现")]),s._v(" "),n("p",[n("code",[s._v("mlse.cn.gmi.h8.erai.001.20150802.txt")])]),s._v(" "),n("p",[n("code",[s._v("mlse.cn.gmi.h8.erai.001.20150803.txt")])]),s._v(" "),n("p",[s._v("对于批量来说，建议一个月分段跑一个，处理一个月在7天左右（0.001精度要求下）。所以建议你后台运行：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nohup")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" batch.sh "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20150801")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20150831")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" log.201508 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$jobs")]),s._v(" -l\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("+ "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15669")]),s._v(" Running          "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" batch.sh "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20150801")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20150831")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" log.201508 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##注意检查日志，运行是否正常。")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])])])]),s._v(" "),n("hr"),s._v(" "),n("h3",{attrs:{id:"结果展示"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#结果展示"}},[s._v("#")]),s._v(" - 结果展示")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("-rwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" hjh hjh   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1857")]),s._v(" Aug "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":20 plot.local.time.ncl*  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 绘制地方时")]),s._v("\n-rwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" hjh hjh   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5102")]),s._v(" Aug "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":20 plot.mlse.ncl*      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 绘制MLSE空间分布")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ul",[n("li",[s._v("地方时")])]),s._v(" "),n("p",[n("img",{attrs:{src:t(313),alt:"1566552312953"}})]),s._v(" "),n("ul",[n("li",[s._v("MLSE谱")])]),s._v(" "),n("p",[n("img",{attrs:{src:t(314),alt:"1566552402106"}})]),s._v(" "),n("p",[s._v("©Jiheng Hu 2019")])])}),[],!1,null,null,null);a.default=e.exports}}]);